{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.virtual_scrolling.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _dom_adapter = _interopRequireDefault(require(\"../../../core/dom_adapter\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../../../events/core/events_engine\"));\n\nvar _window = require(\"../../../core/utils/window\");\n\nvar _index = require(\"../../../events/utils/index\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else {\n      if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar ROW_HEIGHT = 50;\nvar CELL_WIDTH = 150;\nvar MIN_SCROLL_OFFSET = 10;\nvar VIRTUAL_APPOINTMENTS_RENDER_TIMEOUT = 15;\nvar DOCUMENT_SCROLL_EVENT_NAMESPACE = (0, _index.addNamespace)(\"scroll\", \"dxSchedulerVirtualScrolling\");\nvar scrollingTypes = {\n  vertical: \"vertical\",\n  horizontal: \"horizontal\",\n  both: \"both\"\n};\nvar DefaultScrollingType = scrollingTypes.vertical;\n\nvar VirtualScrollingDispatcher = function () {\n  function VirtualScrollingDispatcher(workspace) {\n    this._workspace = workspace;\n    this._rowHeight = ROW_HEIGHT;\n    this._cellWidth = CELL_WIDTH;\n    this._renderer = new Renderer(this.workspace);\n\n    this._createVirtualScrolling();\n\n    this._attachScrollableEvents();\n  }\n\n  var _proto = VirtualScrollingDispatcher.prototype;\n\n  _proto.calculateCoordinatesByDataAndPosition = function (cellData, position, date) {\n    var workSpace = this._workspace;\n    var rowIndex = position.rowIndex,\n        columnIndex = position.columnIndex;\n    var startDate = cellData.startDate,\n        endDate = cellData.endDate,\n        allDay = cellData.allDay;\n    var timeToScroll = date.getTime();\n    var cellStartTime = startDate.getTime();\n    var cellEndTime = endDate.getTime();\n    var scrollInCell = allDay ? 0 : (timeToScroll - cellStartTime) / (cellEndTime - cellStartTime);\n    var cellWidth = workSpace.getCellWidth();\n    var top = (rowIndex + scrollInCell) * this.rowHeight;\n    var left = cellWidth * columnIndex;\n\n    if (workSpace.option(\"rtlEnabled\")) {\n      left = workSpace.getScrollableOuterWidth() - left;\n    }\n\n    return {\n      top: top,\n      left: left\n    };\n  };\n\n  _proto.dispose = function () {\n    if (this._onScrollHandler) {\n      _events_engine.default.off(this.document, DOCUMENT_SCROLL_EVENT_NAMESPACE, this._onScrollHandler);\n    }\n  };\n\n  _proto._createVirtualScrolling = function () {\n    if (this.verticalScrollingAllowed) {\n      this.verticalVirtualScrolling = new VerticalVirtualScrolling({\n        workspace: this.workspace,\n        viewportHeight: this.viewportHeight,\n        rowHeight: this.rowHeight\n      });\n    }\n\n    if (this.horizontalScrollingAllowed) {\n      this.horizontalVirtualScrolling = new HorizontalVirtualScrolling({\n        workspace: this.workspace,\n        viewportWidth: this.viewportWidth,\n        cellWidth: this.cellWidth\n      });\n    }\n  };\n\n  _proto._attachScrollableEvents = function () {\n    if (this.height || this.width) {\n      this._attachScrollableScroll();\n    }\n\n    if (!this.height || !this.width) {\n      this._attachWindowScroll();\n    }\n  };\n\n  _proto._attachScrollableScroll = function () {\n    var _this = this;\n\n    var scrollable = this.workspace.getScrollable();\n    var currentOnScroll = scrollable.option(\"onScroll\");\n    scrollable.option(\"onScroll\", function (e) {\n      null === currentOnScroll || void 0 === currentOnScroll ? void 0 : currentOnScroll.apply(scrollable, [e]);\n\n      _this._process(null === e || void 0 === e ? void 0 : e.scrollOffset);\n    });\n  };\n\n  _proto._attachWindowScroll = function () {\n    var _this2 = this;\n\n    var window = (0, _window.getWindow)();\n    this._onScrollHandler = this.workspace._createAction(function () {\n      var scrollX = window.scrollX,\n          scrollY = window.scrollY;\n\n      if (scrollX >= _this2.minScrollOffset || scrollY >= _this2.minScrollOffset) {\n        _this2._process({\n          left: scrollX,\n          top: scrollY\n        });\n      }\n    });\n\n    _events_engine.default.on(this.document, DOCUMENT_SCROLL_EVENT_NAMESPACE, this._onScrollHandler);\n  };\n\n  _proto._process = function (scrollPosition) {\n    if (scrollPosition) {\n      var _this$verticalVirtual, _this$horizontalVirtu;\n\n      var left = scrollPosition.left,\n          top = scrollPosition.top;\n      null === (_this$verticalVirtual = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual ? void 0 : _this$verticalVirtual.updateState(top);\n      null === (_this$horizontalVirtu = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu ? void 0 : _this$horizontalVirtu.updateState(left);\n      this.renderer.updateRender();\n    }\n  };\n\n  _proto.updateDimensions = function () {\n    var cellHeight = this.workspace.getCellHeight(false);\n    var cellWidth = this.workspace.getCellWidth();\n    var needUpdate = cellHeight !== this.rowHeight || cellWidth !== this.cellWidth;\n\n    if (needUpdate) {\n      this.rowHeight = cellHeight;\n      this.cellWidth = cellWidth;\n\n      this._createVirtualScrolling();\n\n      this.renderer._renderDateTable();\n    }\n  };\n\n  _createClass(VirtualScrollingDispatcher, [{\n    key: \"workspace\",\n    get: function get() {\n      return this._workspace;\n    }\n  }, {\n    key: \"renderer\",\n    get: function get() {\n      return this._renderer;\n    }\n  }, {\n    key: \"isVirtualScrolling\",\n    get: function get() {\n      return this.workspace.isVirtualScrolling();\n    }\n  }, {\n    key: \"minScrollOffset\",\n    get: function get() {\n      return MIN_SCROLL_OFFSET;\n    }\n  }, {\n    key: \"verticalVirtualScrolling\",\n    get: function get() {\n      return this._verticalVirtualScrolling;\n    },\n    set: function set(value) {\n      this._verticalVirtualScrolling = value;\n    }\n  }, {\n    key: \"horizontalVirtualScrolling\",\n    get: function get() {\n      return this._horizontalVirtualScrolling;\n    },\n    set: function set(value) {\n      this._horizontalVirtualScrolling = value;\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      return _dom_adapter.default.getDocument();\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.workspace.invoke(\"getOption\", \"height\");\n    }\n  }, {\n    key: \"width\",\n    get: function get() {\n      return this.workspace.invoke(\"getOption\", \"width\");\n    }\n  }, {\n    key: \"rowHeight\",\n    get: function get() {\n      return this._rowHeight;\n    },\n    set: function set(value) {\n      this._rowHeight = value;\n    }\n  }, {\n    key: \"viewportHeight\",\n    get: function get() {\n      return this.height ? this.workspace.$element().height() : (0, _window.getWindow)().innerHeight;\n    }\n  }, {\n    key: \"cellWidth\",\n    get: function get() {\n      return this._cellWidth;\n    },\n    set: function set(value) {\n      this._cellWidth = value;\n    }\n  }, {\n    key: \"viewportWidth\",\n    get: function get() {\n      return this.width ? this.workspace.$element().width() : (0, _window.getWindow)().innerWidth;\n    }\n  }, {\n    key: \"topVirtualRowsCount\",\n    get: function get() {\n      return this.verticalScrollingState.virtualItemCountBefore > 0 ? 1 : 0;\n    }\n  }, {\n    key: \"scrollingState\",\n    get: function get() {\n      var _this$verticalVirtual2, _this$horizontalVirtu2;\n\n      return {\n        vertical: null === (_this$verticalVirtual2 = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual2 ? void 0 : _this$verticalVirtual2.state,\n        horizontal: null === (_this$horizontalVirtu2 = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu2 ? void 0 : _this$horizontalVirtu2.state\n      };\n    }\n  }, {\n    key: \"verticalScrollingState\",\n    get: function get() {\n      return this.scrollingState.vertical;\n    }\n  }, {\n    key: \"horizontalScrollingState\",\n    get: function get() {\n      return this.scrollingState.horizontal;\n    }\n  }, {\n    key: \"renderState\",\n    get: function get() {\n      var _this$verticalVirtual3, _this$horizontalVirtu3;\n\n      var verticalRenderState = (null === (_this$verticalVirtual3 = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual3 ? void 0 : _this$verticalVirtual3.getRenderState()) || {};\n      var horizontalRenderState = (null === (_this$horizontalVirtu3 = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu3 ? void 0 : _this$horizontalVirtu3.getRenderState()) || {};\n      return _objectSpread(_objectSpread({}, verticalRenderState), horizontalRenderState);\n    }\n  }, {\n    key: \"scrollingType\",\n    get: function get() {\n      return this.workspace.option(\"scrolling.type\") || DefaultScrollingType;\n    }\n  }, {\n    key: \"verticalScrollingAllowed\",\n    get: function get() {\n      return this.scrollingType === scrollingTypes.vertical || this.scrollingType === scrollingTypes.both;\n    }\n  }, {\n    key: \"horizontalScrollingAllowed\",\n    get: function get() {\n      return this.scrollingType === scrollingTypes.horizontal || this.scrollingType === scrollingTypes.both;\n    }\n  }]);\n\n  return VirtualScrollingDispatcher;\n}();\n\nexports.default = VirtualScrollingDispatcher;\n\nvar VirtualScrollingBase = function () {\n  function VirtualScrollingBase(options) {\n    this._workspace = options.workspace;\n    this._state = this.defaultState;\n    this._viewportSize = options.viewportSize;\n    this._itemSize = options.itemSize;\n    this.updateState(0);\n  }\n\n  var _proto2 = VirtualScrollingBase.prototype;\n\n  _proto2.needUpdateState = function (position) {\n    var _this$state = this.state,\n        prevPosition = _this$state.prevPosition,\n        startIndex = _this$state.startIndex;\n    var isFirstInitialization = startIndex < 0;\n\n    if (!isFirstInitialization && (0 === position || position === this.maxScrollPosition)) {\n      return true;\n    }\n\n    var currentPosition = prevPosition;\n    var currentItemsCount = Math.floor(currentPosition / this.itemSize);\n    var itemsCount = Math.floor(position / this.itemSize);\n    var isStartIndexChanged = Math.abs(currentItemsCount - itemsCount) >= this.outlineCount;\n    return isFirstInitialization || isStartIndexChanged;\n  };\n\n  _proto2._correctPosition = function (position) {\n    if (position < 0) {\n      return 0;\n    }\n\n    return Math.min(position, this.maxScrollPosition);\n  };\n\n  _proto2.updateState = function (position) {\n    position = this._correctPosition(position);\n\n    if (!this.needUpdateState(position)) {\n      return false;\n    }\n\n    var itemsInfoBefore = this._calcItemInfoBefore(position);\n\n    var itemsDeltaBefore = this._calcItemDeltaBefore(itemsInfoBefore);\n\n    var _this$_calcItemInfoAf = this._calcItemInfoAfter(itemsDeltaBefore),\n        outlineCountAfter = _this$_calcItemInfoAf.outlineCountAfter,\n        virtualItemCountAfter = _this$_calcItemInfoAf.virtualItemCountAfter,\n        itemCountWithAfter = _this$_calcItemInfoAf.itemCountWithAfter;\n\n    var virtualItemCountBefore = itemsInfoBefore.virtualItemCountBefore,\n        outlineCountBefore = itemsInfoBefore.outlineCountBefore;\n    var itemCount = outlineCountBefore + itemCountWithAfter + outlineCountAfter;\n    var itemCountAfter = Math.floor(position / this.itemSize);\n    this.state.prevPosition = itemCountAfter * this.itemSize;\n    this.state.startIndex = itemCountAfter - outlineCountBefore;\n    this.state.virtualItemCountBefore = virtualItemCountBefore;\n    this.state.outlineCountBefore = outlineCountBefore;\n    this.state.itemCount = itemCount;\n    this.state.outlineCountAfter = outlineCountAfter;\n    this.state.virtualItemCountAfter = virtualItemCountAfter;\n\n    this._updateStateCore();\n\n    return true;\n  };\n\n  _proto2._calcItemInfoBefore = function (position) {\n    var virtualItemCountBefore = Math.floor(position / this.itemSize);\n    var outlineCountBefore = Math.min(virtualItemCountBefore, this.outlineCount);\n    virtualItemCountBefore -= outlineCountBefore;\n    return {\n      virtualItemCountBefore: virtualItemCountBefore,\n      outlineCountBefore: outlineCountBefore\n    };\n  };\n\n  _proto2._calcItemDeltaBefore = function (itemInfoBefore) {\n    var virtualItemCountBefore = itemInfoBefore.virtualItemCountBefore,\n        outlineCountBefore = itemInfoBefore.outlineCountBefore;\n    var totalItemCount = this.getTotalItemCount();\n    return totalItemCount - virtualItemCountBefore - outlineCountBefore;\n  };\n\n  _proto2.getTotalItemCount = function () {\n    throw \"getTotalItemCount method should be implemented\";\n  };\n\n  _proto2.getRenderState = function () {\n    throw \"getRenderState method should be implemented\";\n  };\n\n  _proto2._calcItemInfoAfter = function (itemsDeltaBefore) {\n    var itemCountWithAfter = itemsDeltaBefore >= this.pageSize ? this.pageSize : itemsDeltaBefore;\n    var virtualItemCountAfter = itemsDeltaBefore - itemCountWithAfter;\n    var outlineCountAfter = virtualItemCountAfter > 0 ? Math.min(virtualItemCountAfter, this.outlineCount) : 0;\n\n    if (virtualItemCountAfter > 0) {\n      virtualItemCountAfter -= outlineCountAfter;\n    }\n\n    return {\n      virtualItemCountAfter: virtualItemCountAfter,\n      outlineCountAfter: outlineCountAfter,\n      itemCountWithAfter: itemCountWithAfter\n    };\n  };\n\n  _proto2._updateStateCore = function () {\n    var state = this.state;\n    var virtualItemCountBefore = state.virtualItemCountBefore;\n    var virtualItemCountAfter = state.virtualItemCountAfter;\n    var outlineCountBefore = state.outlineCountBefore;\n    var outlineCountAfter = state.outlineCountAfter;\n    var prevVirtualItemSizeBefore = state.virtualItemSizeBefore;\n    var prevVirtualItemSizeAfter = state.virtualItemSizeAfter;\n    var prevOutlineSizeBefore = state.outlineSizeBefore;\n    var prevOutlineSizeAfter = state.outlineSizeAfter;\n    var virtualItemSizeBefore = this.itemSize * virtualItemCountBefore;\n    var virtualItemSizeAfter = this.itemSize * virtualItemCountAfter;\n    var outlineSizeBefore = this.itemSize * outlineCountBefore;\n    var outlineSizeAfter = this.itemSize * outlineCountAfter;\n    var prevVirtualSizeBefore = prevVirtualItemSizeBefore + prevOutlineSizeBefore;\n    var virtualSizeBefore = virtualItemSizeBefore + outlineSizeBefore;\n    var prevVirtualSizeAfter = prevVirtualItemSizeAfter + prevOutlineSizeAfter;\n    var virtualSizeAfter = virtualItemSizeAfter + outlineSizeAfter;\n    var isAppend = prevVirtualSizeBefore < virtualSizeBefore;\n    var isPrepend = prevVirtualSizeAfter < virtualSizeAfter;\n    var needAddItems = isAppend || isPrepend;\n\n    if (needAddItems) {\n      state.virtualItemSizeBefore = virtualItemSizeBefore;\n      state.virtualItemSizeAfter = virtualItemSizeAfter;\n    }\n  };\n\n  _createClass(VirtualScrollingBase, [{\n    key: \"viewportSize\",\n    get: function get() {\n      return this._viewportSize;\n    }\n  }, {\n    key: \"itemSize\",\n    get: function get() {\n      return this._itemSize;\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this._state;\n    },\n    set: function set(value) {\n      this._state = value;\n    }\n  }, {\n    key: \"startIndex\",\n    get: function get() {\n      return this.state.startIndex;\n    }\n  }, {\n    key: \"pageSize\",\n    get: function get() {\n      return Math.ceil(this.viewportSize / this.itemSize);\n    }\n  }, {\n    key: \"outlineCount\",\n    get: function get() {\n      return Math.floor(this.pageSize / 2);\n    }\n  }, {\n    key: \"workspace\",\n    get: function get() {\n      return this._workspace;\n    }\n  }, {\n    key: \"groupCount\",\n    get: function get() {\n      return this.workspace._getGroupCount();\n    }\n  }, {\n    key: \"isVerticalGrouping\",\n    get: function get() {\n      return this.workspace._isVerticalGroupedWorkSpace();\n    }\n  }, {\n    key: \"defaultState\",\n    get: function get() {\n      return {\n        prevPosition: 0,\n        startIndex: -1,\n        itemCount: 0,\n        virtualItemCountBefore: 0,\n        virtualItemCountAfter: 0,\n        outlineCountBefore: 0,\n        outlineCountAfter: 0,\n        virtualItemSizeBefore: 0,\n        virtualItemSizeAfter: 0,\n        outlineSizeBefore: 0,\n        outlineSizeAfter: 0\n      };\n    }\n  }, {\n    key: \"maxScrollPosition\",\n    get: function get() {\n      return this.getTotalItemCount() * this.itemSize - this.viewportSize;\n    }\n  }]);\n\n  return VirtualScrollingBase;\n}();\n\nvar VerticalVirtualScrolling = function (_VirtualScrollingBase) {\n  _inheritsLoose(VerticalVirtualScrolling, _VirtualScrollingBase);\n\n  function VerticalVirtualScrolling(options) {\n    return _VirtualScrollingBase.call(this, {\n      workspace: options.workspace,\n      viewportSize: options.viewportHeight,\n      itemSize: options.rowHeight\n    }) || this;\n  }\n\n  var _proto3 = VerticalVirtualScrolling.prototype;\n\n  _proto3.getTotalItemCount = function () {\n    return this.workspace._getTotalRowCount(this.groupCount, this.isVerticalGrouping);\n  };\n\n  _proto3.getRenderState = function () {\n    return {\n      topVirtualRowHeight: this.state.virtualItemSizeBefore,\n      bottomVirtualRowHeight: this.state.virtualItemSizeAfter,\n      startRowIndex: this.state.startIndex,\n      rowCount: this.state.itemCount,\n      startIndex: this.state.startIndex\n    };\n  };\n\n  _createClass(VerticalVirtualScrolling, [{\n    key: \"prevTopPosition\",\n    get: function get() {\n      return this.state.prevPosition;\n    }\n  }, {\n    key: \"rowCount\",\n    get: function get() {\n      return this.state.itemCount;\n    }\n  }, {\n    key: \"topVirtualRowCount\",\n    get: function get() {\n      return this.state.virtualItemCountBefore;\n    }\n  }, {\n    key: \"bottomVirtualRowCount\",\n    get: function get() {\n      return this.state.virtualItemCountAfter;\n    }\n  }]);\n\n  return VerticalVirtualScrolling;\n}(VirtualScrollingBase);\n\nvar HorizontalVirtualScrolling = function (_VirtualScrollingBase2) {\n  _inheritsLoose(HorizontalVirtualScrolling, _VirtualScrollingBase2);\n\n  function HorizontalVirtualScrolling(options) {\n    return _VirtualScrollingBase2.call(this, {\n      workspace: options.workspace,\n      viewportSize: options.viewportWidth,\n      itemSize: options.cellWidth\n    }) || this;\n  }\n\n  var _proto4 = HorizontalVirtualScrolling.prototype;\n\n  _proto4.getTotalItemCount = function () {\n    return this.workspace._getTotalCellCount(this.groupCount, this.isVerticalGrouping);\n  };\n\n  _proto4.getRenderState = function () {\n    return {\n      leftVirtualCellWidth: this.state.virtualItemSizeBefore,\n      rightVirtualCellWidth: this.state.virtualItemSizeAfter,\n      startCellIndex: this.state.startIndex,\n      cellCount: this.state.itemCount,\n      cellWidth: this.state.itemSize\n    };\n  };\n\n  return HorizontalVirtualScrolling;\n}(VirtualScrollingBase);\n\nvar Renderer = function () {\n  function Renderer(workspace) {\n    this._workspace = workspace;\n    this._renderAppointmentTimeout = null;\n  }\n\n  var _proto5 = Renderer.prototype;\n\n  _proto5.getRenderTimeout = function () {\n    return VIRTUAL_APPOINTMENTS_RENDER_TIMEOUT;\n  };\n\n  _proto5.updateRender = function () {\n    this._renderDateTable();\n\n    this._renderAppointments();\n  };\n\n  _proto5._renderDateTable = function () {\n    this.workspace.renderRWorkspace(false);\n  };\n\n  _proto5._renderAppointments = function () {\n    var _this3 = this;\n\n    var renderTimeout = this.getRenderTimeout();\n\n    if (renderTimeout >= 0) {\n      clearTimeout(this._renderAppointmentTimeout);\n      this._renderAppointmentTimeout = setTimeout(function () {\n        return _this3.workspace.updateAppointments();\n      }, renderTimeout);\n    } else {\n      this.workspace.updateAppointments();\n    }\n  };\n\n  _createClass(Renderer, [{\n    key: \"workspace\",\n    get: function get() {\n      return this._workspace;\n    }\n  }]);\n\n  return Renderer;\n}();\n\nmodule.exports = exports.default;","map":{"version":3,"sources":["/home/emma/node_modules/devextreme/ui/scheduler/workspaces/ui.scheduler.virtual_scrolling.js"],"names":["exports","default","_dom_adapter","_interopRequireDefault","require","_events_engine","_window","_index","obj","__esModule","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","configurable","writable","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","ROW_HEIGHT","CELL_WIDTH","MIN_SCROLL_OFFSET","VIRTUAL_APPOINTMENTS_RENDER_TIMEOUT","DOCUMENT_SCROLL_EVENT_NAMESPACE","addNamespace","scrollingTypes","vertical","horizontal","both","DefaultScrollingType","VirtualScrollingDispatcher","workspace","_workspace","_rowHeight","_cellWidth","_renderer","Renderer","_createVirtualScrolling","_attachScrollableEvents","_proto","calculateCoordinatesByDataAndPosition","cellData","position","date","workSpace","rowIndex","columnIndex","startDate","endDate","allDay","timeToScroll","getTime","cellStartTime","cellEndTime","scrollInCell","cellWidth","getCellWidth","top","rowHeight","left","option","getScrollableOuterWidth","dispose","_onScrollHandler","off","document","verticalScrollingAllowed","verticalVirtualScrolling","VerticalVirtualScrolling","viewportHeight","horizontalScrollingAllowed","horizontalVirtualScrolling","HorizontalVirtualScrolling","viewportWidth","height","width","_attachScrollableScroll","_attachWindowScroll","_this","scrollable","getScrollable","currentOnScroll","e","_process","scrollOffset","_this2","window","getWindow","_createAction","scrollX","scrollY","minScrollOffset","on","scrollPosition","_this$verticalVirtual","_this$horizontalVirtu","updateState","renderer","updateRender","updateDimensions","cellHeight","getCellHeight","needUpdate","_renderDateTable","get","isVirtualScrolling","_verticalVirtualScrolling","set","_horizontalVirtualScrolling","getDocument","invoke","$element","innerHeight","innerWidth","verticalScrollingState","virtualItemCountBefore","_this$verticalVirtual2","_this$horizontalVirtu2","state","scrollingState","_this$verticalVirtual3","_this$horizontalVirtu3","verticalRenderState","getRenderState","horizontalRenderState","scrollingType","VirtualScrollingBase","options","_state","defaultState","_viewportSize","viewportSize","_itemSize","itemSize","_proto2","needUpdateState","_this$state","prevPosition","startIndex","isFirstInitialization","maxScrollPosition","currentPosition","currentItemsCount","Math","floor","itemsCount","isStartIndexChanged","abs","outlineCount","_correctPosition","min","itemsInfoBefore","_calcItemInfoBefore","itemsDeltaBefore","_calcItemDeltaBefore","_this$_calcItemInfoAf","_calcItemInfoAfter","outlineCountAfter","virtualItemCountAfter","itemCountWithAfter","outlineCountBefore","itemCount","itemCountAfter","_updateStateCore","itemInfoBefore","totalItemCount","getTotalItemCount","pageSize","prevVirtualItemSizeBefore","virtualItemSizeBefore","prevVirtualItemSizeAfter","virtualItemSizeAfter","prevOutlineSizeBefore","outlineSizeBefore","prevOutlineSizeAfter","outlineSizeAfter","prevVirtualSizeBefore","virtualSizeBefore","prevVirtualSizeAfter","virtualSizeAfter","isAppend","isPrepend","needAddItems","ceil","_getGroupCount","_isVerticalGroupedWorkSpace","_VirtualScrollingBase","call","_proto3","_getTotalRowCount","groupCount","isVerticalGrouping","topVirtualRowHeight","bottomVirtualRowHeight","startRowIndex","rowCount","_VirtualScrollingBase2","_proto4","_getTotalCellCount","leftVirtualCellWidth","rightVirtualCellWidth","startCellIndex","cellCount","_renderAppointmentTimeout","_proto5","getRenderTimeout","_renderAppointments","renderRWorkspace","_this3","renderTimeout","clearTimeout","setTimeout","updateAppointments","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.virtual_scrolling.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _dom_adapter = _interopRequireDefault(require(\"../../../core/dom_adapter\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../../../events/core/events_engine\"));\r\nvar _window = require(\"../../../core/utils/window\");\r\nvar _index = require(\"../../../events/utils/index\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _inheritsLoose(subClass, superClass) {\r\n    subClass.prototype = Object.create(superClass.prototype);\r\n    subClass.prototype.constructor = subClass;\r\n    _setPrototypeOf(subClass, superClass)\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n    var keys = Object.keys(object);\r\n    if (Object.getOwnPropertySymbols) {\r\n        var symbols = Object.getOwnPropertySymbols(object);\r\n        if (enumerableOnly) {\r\n            symbols = symbols.filter(function(sym) {\r\n                return Object.getOwnPropertyDescriptor(object, sym).enumerable\r\n            })\r\n        }\r\n        keys.push.apply(keys, symbols)\r\n    }\r\n    return keys\r\n}\r\n\r\nfunction _objectSpread(target) {\r\n    for (var i = 1; i < arguments.length; i++) {\r\n        var source = null != arguments[i] ? arguments[i] : {};\r\n        if (i % 2) {\r\n            ownKeys(Object(source), true).forEach(function(key) {\r\n                _defineProperty(target, key, source[key])\r\n            })\r\n        } else {\r\n            if (Object.getOwnPropertyDescriptors) {\r\n                Object.defineProperties(target, Object.getOwnPropertyDescriptors(source))\r\n            } else {\r\n                ownKeys(Object(source)).forEach(function(key) {\r\n                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key))\r\n                })\r\n            }\r\n        }\r\n    }\r\n    return target\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n    if (key in obj) {\r\n        Object.defineProperty(obj, key, {\r\n            value: value,\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true\r\n        })\r\n    } else {\r\n        obj[key] = value\r\n    }\r\n    return obj\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar ROW_HEIGHT = 50;\r\nvar CELL_WIDTH = 150;\r\nvar MIN_SCROLL_OFFSET = 10;\r\nvar VIRTUAL_APPOINTMENTS_RENDER_TIMEOUT = 15;\r\nvar DOCUMENT_SCROLL_EVENT_NAMESPACE = (0, _index.addNamespace)(\"scroll\", \"dxSchedulerVirtualScrolling\");\r\nvar scrollingTypes = {\r\n    vertical: \"vertical\",\r\n    horizontal: \"horizontal\",\r\n    both: \"both\"\r\n};\r\nvar DefaultScrollingType = scrollingTypes.vertical;\r\nvar VirtualScrollingDispatcher = function() {\r\n    function VirtualScrollingDispatcher(workspace) {\r\n        this._workspace = workspace;\r\n        this._rowHeight = ROW_HEIGHT;\r\n        this._cellWidth = CELL_WIDTH;\r\n        this._renderer = new Renderer(this.workspace);\r\n        this._createVirtualScrolling();\r\n        this._attachScrollableEvents()\r\n    }\r\n    var _proto = VirtualScrollingDispatcher.prototype;\r\n    _proto.calculateCoordinatesByDataAndPosition = function(cellData, position, date) {\r\n        var workSpace = this._workspace;\r\n        var rowIndex = position.rowIndex,\r\n            columnIndex = position.columnIndex;\r\n        var startDate = cellData.startDate,\r\n            endDate = cellData.endDate,\r\n            allDay = cellData.allDay;\r\n        var timeToScroll = date.getTime();\r\n        var cellStartTime = startDate.getTime();\r\n        var cellEndTime = endDate.getTime();\r\n        var scrollInCell = allDay ? 0 : (timeToScroll - cellStartTime) / (cellEndTime - cellStartTime);\r\n        var cellWidth = workSpace.getCellWidth();\r\n        var top = (rowIndex + scrollInCell) * this.rowHeight;\r\n        var left = cellWidth * columnIndex;\r\n        if (workSpace.option(\"rtlEnabled\")) {\r\n            left = workSpace.getScrollableOuterWidth() - left\r\n        }\r\n        return {\r\n            top: top,\r\n            left: left\r\n        }\r\n    };\r\n    _proto.dispose = function() {\r\n        if (this._onScrollHandler) {\r\n            _events_engine.default.off(this.document, DOCUMENT_SCROLL_EVENT_NAMESPACE, this._onScrollHandler)\r\n        }\r\n    };\r\n    _proto._createVirtualScrolling = function() {\r\n        if (this.verticalScrollingAllowed) {\r\n            this.verticalVirtualScrolling = new VerticalVirtualScrolling({\r\n                workspace: this.workspace,\r\n                viewportHeight: this.viewportHeight,\r\n                rowHeight: this.rowHeight\r\n            })\r\n        }\r\n        if (this.horizontalScrollingAllowed) {\r\n            this.horizontalVirtualScrolling = new HorizontalVirtualScrolling({\r\n                workspace: this.workspace,\r\n                viewportWidth: this.viewportWidth,\r\n                cellWidth: this.cellWidth\r\n            })\r\n        }\r\n    };\r\n    _proto._attachScrollableEvents = function() {\r\n        if (this.height || this.width) {\r\n            this._attachScrollableScroll()\r\n        }\r\n        if (!this.height || !this.width) {\r\n            this._attachWindowScroll()\r\n        }\r\n    };\r\n    _proto._attachScrollableScroll = function() {\r\n        var _this = this;\r\n        var scrollable = this.workspace.getScrollable();\r\n        var currentOnScroll = scrollable.option(\"onScroll\");\r\n        scrollable.option(\"onScroll\", function(e) {\r\n            null === currentOnScroll || void 0 === currentOnScroll ? void 0 : currentOnScroll.apply(scrollable, [e]);\r\n            _this._process(null === e || void 0 === e ? void 0 : e.scrollOffset)\r\n        })\r\n    };\r\n    _proto._attachWindowScroll = function() {\r\n        var _this2 = this;\r\n        var window = (0, _window.getWindow)();\r\n        this._onScrollHandler = this.workspace._createAction(function() {\r\n            var scrollX = window.scrollX,\r\n                scrollY = window.scrollY;\r\n            if (scrollX >= _this2.minScrollOffset || scrollY >= _this2.minScrollOffset) {\r\n                _this2._process({\r\n                    left: scrollX,\r\n                    top: scrollY\r\n                })\r\n            }\r\n        });\r\n        _events_engine.default.on(this.document, DOCUMENT_SCROLL_EVENT_NAMESPACE, this._onScrollHandler)\r\n    };\r\n    _proto._process = function(scrollPosition) {\r\n        if (scrollPosition) {\r\n            var _this$verticalVirtual, _this$horizontalVirtu;\r\n            var left = scrollPosition.left,\r\n                top = scrollPosition.top;\r\n            null === (_this$verticalVirtual = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual ? void 0 : _this$verticalVirtual.updateState(top);\r\n            null === (_this$horizontalVirtu = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu ? void 0 : _this$horizontalVirtu.updateState(left);\r\n            this.renderer.updateRender()\r\n        }\r\n    };\r\n    _proto.updateDimensions = function() {\r\n        var cellHeight = this.workspace.getCellHeight(false);\r\n        var cellWidth = this.workspace.getCellWidth();\r\n        var needUpdate = cellHeight !== this.rowHeight || cellWidth !== this.cellWidth;\r\n        if (needUpdate) {\r\n            this.rowHeight = cellHeight;\r\n            this.cellWidth = cellWidth;\r\n            this._createVirtualScrolling();\r\n            this.renderer._renderDateTable()\r\n        }\r\n    };\r\n    _createClass(VirtualScrollingDispatcher, [{\r\n        key: \"workspace\",\r\n        get: function() {\r\n            return this._workspace\r\n        }\r\n    }, {\r\n        key: \"renderer\",\r\n        get: function() {\r\n            return this._renderer\r\n        }\r\n    }, {\r\n        key: \"isVirtualScrolling\",\r\n        get: function() {\r\n            return this.workspace.isVirtualScrolling()\r\n        }\r\n    }, {\r\n        key: \"minScrollOffset\",\r\n        get: function() {\r\n            return MIN_SCROLL_OFFSET\r\n        }\r\n    }, {\r\n        key: \"verticalVirtualScrolling\",\r\n        get: function() {\r\n            return this._verticalVirtualScrolling\r\n        },\r\n        set: function(value) {\r\n            this._verticalVirtualScrolling = value\r\n        }\r\n    }, {\r\n        key: \"horizontalVirtualScrolling\",\r\n        get: function() {\r\n            return this._horizontalVirtualScrolling\r\n        },\r\n        set: function(value) {\r\n            this._horizontalVirtualScrolling = value\r\n        }\r\n    }, {\r\n        key: \"document\",\r\n        get: function() {\r\n            return _dom_adapter.default.getDocument()\r\n        }\r\n    }, {\r\n        key: \"height\",\r\n        get: function() {\r\n            return this.workspace.invoke(\"getOption\", \"height\")\r\n        }\r\n    }, {\r\n        key: \"width\",\r\n        get: function() {\r\n            return this.workspace.invoke(\"getOption\", \"width\")\r\n        }\r\n    }, {\r\n        key: \"rowHeight\",\r\n        get: function() {\r\n            return this._rowHeight\r\n        },\r\n        set: function(value) {\r\n            this._rowHeight = value\r\n        }\r\n    }, {\r\n        key: \"viewportHeight\",\r\n        get: function() {\r\n            return this.height ? this.workspace.$element().height() : (0, _window.getWindow)().innerHeight\r\n        }\r\n    }, {\r\n        key: \"cellWidth\",\r\n        get: function() {\r\n            return this._cellWidth\r\n        },\r\n        set: function(value) {\r\n            this._cellWidth = value\r\n        }\r\n    }, {\r\n        key: \"viewportWidth\",\r\n        get: function() {\r\n            return this.width ? this.workspace.$element().width() : (0, _window.getWindow)().innerWidth\r\n        }\r\n    }, {\r\n        key: \"topVirtualRowsCount\",\r\n        get: function() {\r\n            return this.verticalScrollingState.virtualItemCountBefore > 0 ? 1 : 0\r\n        }\r\n    }, {\r\n        key: \"scrollingState\",\r\n        get: function() {\r\n            var _this$verticalVirtual2, _this$horizontalVirtu2;\r\n            return {\r\n                vertical: null === (_this$verticalVirtual2 = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual2 ? void 0 : _this$verticalVirtual2.state,\r\n                horizontal: null === (_this$horizontalVirtu2 = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu2 ? void 0 : _this$horizontalVirtu2.state\r\n            }\r\n        }\r\n    }, {\r\n        key: \"verticalScrollingState\",\r\n        get: function() {\r\n            return this.scrollingState.vertical\r\n        }\r\n    }, {\r\n        key: \"horizontalScrollingState\",\r\n        get: function() {\r\n            return this.scrollingState.horizontal\r\n        }\r\n    }, {\r\n        key: \"renderState\",\r\n        get: function() {\r\n            var _this$verticalVirtual3, _this$horizontalVirtu3;\r\n            var verticalRenderState = (null === (_this$verticalVirtual3 = this.verticalVirtualScrolling) || void 0 === _this$verticalVirtual3 ? void 0 : _this$verticalVirtual3.getRenderState()) || {};\r\n            var horizontalRenderState = (null === (_this$horizontalVirtu3 = this.horizontalVirtualScrolling) || void 0 === _this$horizontalVirtu3 ? void 0 : _this$horizontalVirtu3.getRenderState()) || {};\r\n            return _objectSpread(_objectSpread({}, verticalRenderState), horizontalRenderState)\r\n        }\r\n    }, {\r\n        key: \"scrollingType\",\r\n        get: function() {\r\n            return this.workspace.option(\"scrolling.type\") || DefaultScrollingType\r\n        }\r\n    }, {\r\n        key: \"verticalScrollingAllowed\",\r\n        get: function() {\r\n            return this.scrollingType === scrollingTypes.vertical || this.scrollingType === scrollingTypes.both\r\n        }\r\n    }, {\r\n        key: \"horizontalScrollingAllowed\",\r\n        get: function() {\r\n            return this.scrollingType === scrollingTypes.horizontal || this.scrollingType === scrollingTypes.both\r\n        }\r\n    }]);\r\n    return VirtualScrollingDispatcher\r\n}();\r\nexports.default = VirtualScrollingDispatcher;\r\nvar VirtualScrollingBase = function() {\r\n    function VirtualScrollingBase(options) {\r\n        this._workspace = options.workspace;\r\n        this._state = this.defaultState;\r\n        this._viewportSize = options.viewportSize;\r\n        this._itemSize = options.itemSize;\r\n        this.updateState(0)\r\n    }\r\n    var _proto2 = VirtualScrollingBase.prototype;\r\n    _proto2.needUpdateState = function(position) {\r\n        var _this$state = this.state,\r\n            prevPosition = _this$state.prevPosition,\r\n            startIndex = _this$state.startIndex;\r\n        var isFirstInitialization = startIndex < 0;\r\n        if (!isFirstInitialization && (0 === position || position === this.maxScrollPosition)) {\r\n            return true\r\n        }\r\n        var currentPosition = prevPosition;\r\n        var currentItemsCount = Math.floor(currentPosition / this.itemSize);\r\n        var itemsCount = Math.floor(position / this.itemSize);\r\n        var isStartIndexChanged = Math.abs(currentItemsCount - itemsCount) >= this.outlineCount;\r\n        return isFirstInitialization || isStartIndexChanged\r\n    };\r\n    _proto2._correctPosition = function(position) {\r\n        if (position < 0) {\r\n            return 0\r\n        }\r\n        return Math.min(position, this.maxScrollPosition)\r\n    };\r\n    _proto2.updateState = function(position) {\r\n        position = this._correctPosition(position);\r\n        if (!this.needUpdateState(position)) {\r\n            return false\r\n        }\r\n        var itemsInfoBefore = this._calcItemInfoBefore(position);\r\n        var itemsDeltaBefore = this._calcItemDeltaBefore(itemsInfoBefore);\r\n        var _this$_calcItemInfoAf = this._calcItemInfoAfter(itemsDeltaBefore),\r\n            outlineCountAfter = _this$_calcItemInfoAf.outlineCountAfter,\r\n            virtualItemCountAfter = _this$_calcItemInfoAf.virtualItemCountAfter,\r\n            itemCountWithAfter = _this$_calcItemInfoAf.itemCountWithAfter;\r\n        var virtualItemCountBefore = itemsInfoBefore.virtualItemCountBefore,\r\n            outlineCountBefore = itemsInfoBefore.outlineCountBefore;\r\n        var itemCount = outlineCountBefore + itemCountWithAfter + outlineCountAfter;\r\n        var itemCountAfter = Math.floor(position / this.itemSize);\r\n        this.state.prevPosition = itemCountAfter * this.itemSize;\r\n        this.state.startIndex = itemCountAfter - outlineCountBefore;\r\n        this.state.virtualItemCountBefore = virtualItemCountBefore;\r\n        this.state.outlineCountBefore = outlineCountBefore;\r\n        this.state.itemCount = itemCount;\r\n        this.state.outlineCountAfter = outlineCountAfter;\r\n        this.state.virtualItemCountAfter = virtualItemCountAfter;\r\n        this._updateStateCore();\r\n        return true\r\n    };\r\n    _proto2._calcItemInfoBefore = function(position) {\r\n        var virtualItemCountBefore = Math.floor(position / this.itemSize);\r\n        var outlineCountBefore = Math.min(virtualItemCountBefore, this.outlineCount);\r\n        virtualItemCountBefore -= outlineCountBefore;\r\n        return {\r\n            virtualItemCountBefore: virtualItemCountBefore,\r\n            outlineCountBefore: outlineCountBefore\r\n        }\r\n    };\r\n    _proto2._calcItemDeltaBefore = function(itemInfoBefore) {\r\n        var virtualItemCountBefore = itemInfoBefore.virtualItemCountBefore,\r\n            outlineCountBefore = itemInfoBefore.outlineCountBefore;\r\n        var totalItemCount = this.getTotalItemCount();\r\n        return totalItemCount - virtualItemCountBefore - outlineCountBefore\r\n    };\r\n    _proto2.getTotalItemCount = function() {\r\n        throw \"getTotalItemCount method should be implemented\"\r\n    };\r\n    _proto2.getRenderState = function() {\r\n        throw \"getRenderState method should be implemented\"\r\n    };\r\n    _proto2._calcItemInfoAfter = function(itemsDeltaBefore) {\r\n        var itemCountWithAfter = itemsDeltaBefore >= this.pageSize ? this.pageSize : itemsDeltaBefore;\r\n        var virtualItemCountAfter = itemsDeltaBefore - itemCountWithAfter;\r\n        var outlineCountAfter = virtualItemCountAfter > 0 ? Math.min(virtualItemCountAfter, this.outlineCount) : 0;\r\n        if (virtualItemCountAfter > 0) {\r\n            virtualItemCountAfter -= outlineCountAfter\r\n        }\r\n        return {\r\n            virtualItemCountAfter: virtualItemCountAfter,\r\n            outlineCountAfter: outlineCountAfter,\r\n            itemCountWithAfter: itemCountWithAfter\r\n        }\r\n    };\r\n    _proto2._updateStateCore = function() {\r\n        var state = this.state;\r\n        var virtualItemCountBefore = state.virtualItemCountBefore;\r\n        var virtualItemCountAfter = state.virtualItemCountAfter;\r\n        var outlineCountBefore = state.outlineCountBefore;\r\n        var outlineCountAfter = state.outlineCountAfter;\r\n        var prevVirtualItemSizeBefore = state.virtualItemSizeBefore;\r\n        var prevVirtualItemSizeAfter = state.virtualItemSizeAfter;\r\n        var prevOutlineSizeBefore = state.outlineSizeBefore;\r\n        var prevOutlineSizeAfter = state.outlineSizeAfter;\r\n        var virtualItemSizeBefore = this.itemSize * virtualItemCountBefore;\r\n        var virtualItemSizeAfter = this.itemSize * virtualItemCountAfter;\r\n        var outlineSizeBefore = this.itemSize * outlineCountBefore;\r\n        var outlineSizeAfter = this.itemSize * outlineCountAfter;\r\n        var prevVirtualSizeBefore = prevVirtualItemSizeBefore + prevOutlineSizeBefore;\r\n        var virtualSizeBefore = virtualItemSizeBefore + outlineSizeBefore;\r\n        var prevVirtualSizeAfter = prevVirtualItemSizeAfter + prevOutlineSizeAfter;\r\n        var virtualSizeAfter = virtualItemSizeAfter + outlineSizeAfter;\r\n        var isAppend = prevVirtualSizeBefore < virtualSizeBefore;\r\n        var isPrepend = prevVirtualSizeAfter < virtualSizeAfter;\r\n        var needAddItems = isAppend || isPrepend;\r\n        if (needAddItems) {\r\n            state.virtualItemSizeBefore = virtualItemSizeBefore;\r\n            state.virtualItemSizeAfter = virtualItemSizeAfter\r\n        }\r\n    };\r\n    _createClass(VirtualScrollingBase, [{\r\n        key: \"viewportSize\",\r\n        get: function() {\r\n            return this._viewportSize\r\n        }\r\n    }, {\r\n        key: \"itemSize\",\r\n        get: function() {\r\n            return this._itemSize\r\n        }\r\n    }, {\r\n        key: \"state\",\r\n        get: function() {\r\n            return this._state\r\n        },\r\n        set: function(value) {\r\n            this._state = value\r\n        }\r\n    }, {\r\n        key: \"startIndex\",\r\n        get: function() {\r\n            return this.state.startIndex\r\n        }\r\n    }, {\r\n        key: \"pageSize\",\r\n        get: function() {\r\n            return Math.ceil(this.viewportSize / this.itemSize)\r\n        }\r\n    }, {\r\n        key: \"outlineCount\",\r\n        get: function() {\r\n            return Math.floor(this.pageSize / 2)\r\n        }\r\n    }, {\r\n        key: \"workspace\",\r\n        get: function() {\r\n            return this._workspace\r\n        }\r\n    }, {\r\n        key: \"groupCount\",\r\n        get: function() {\r\n            return this.workspace._getGroupCount()\r\n        }\r\n    }, {\r\n        key: \"isVerticalGrouping\",\r\n        get: function() {\r\n            return this.workspace._isVerticalGroupedWorkSpace()\r\n        }\r\n    }, {\r\n        key: \"defaultState\",\r\n        get: function() {\r\n            return {\r\n                prevPosition: 0,\r\n                startIndex: -1,\r\n                itemCount: 0,\r\n                virtualItemCountBefore: 0,\r\n                virtualItemCountAfter: 0,\r\n                outlineCountBefore: 0,\r\n                outlineCountAfter: 0,\r\n                virtualItemSizeBefore: 0,\r\n                virtualItemSizeAfter: 0,\r\n                outlineSizeBefore: 0,\r\n                outlineSizeAfter: 0\r\n            }\r\n        }\r\n    }, {\r\n        key: \"maxScrollPosition\",\r\n        get: function() {\r\n            return this.getTotalItemCount() * this.itemSize - this.viewportSize\r\n        }\r\n    }]);\r\n    return VirtualScrollingBase\r\n}();\r\nvar VerticalVirtualScrolling = function(_VirtualScrollingBase) {\r\n    _inheritsLoose(VerticalVirtualScrolling, _VirtualScrollingBase);\r\n\r\n    function VerticalVirtualScrolling(options) {\r\n        return _VirtualScrollingBase.call(this, {\r\n            workspace: options.workspace,\r\n            viewportSize: options.viewportHeight,\r\n            itemSize: options.rowHeight\r\n        }) || this\r\n    }\r\n    var _proto3 = VerticalVirtualScrolling.prototype;\r\n    _proto3.getTotalItemCount = function() {\r\n        return this.workspace._getTotalRowCount(this.groupCount, this.isVerticalGrouping)\r\n    };\r\n    _proto3.getRenderState = function() {\r\n        return {\r\n            topVirtualRowHeight: this.state.virtualItemSizeBefore,\r\n            bottomVirtualRowHeight: this.state.virtualItemSizeAfter,\r\n            startRowIndex: this.state.startIndex,\r\n            rowCount: this.state.itemCount,\r\n            startIndex: this.state.startIndex\r\n        }\r\n    };\r\n    _createClass(VerticalVirtualScrolling, [{\r\n        key: \"prevTopPosition\",\r\n        get: function() {\r\n            return this.state.prevPosition\r\n        }\r\n    }, {\r\n        key: \"rowCount\",\r\n        get: function() {\r\n            return this.state.itemCount\r\n        }\r\n    }, {\r\n        key: \"topVirtualRowCount\",\r\n        get: function() {\r\n            return this.state.virtualItemCountBefore\r\n        }\r\n    }, {\r\n        key: \"bottomVirtualRowCount\",\r\n        get: function() {\r\n            return this.state.virtualItemCountAfter\r\n        }\r\n    }]);\r\n    return VerticalVirtualScrolling\r\n}(VirtualScrollingBase);\r\nvar HorizontalVirtualScrolling = function(_VirtualScrollingBase2) {\r\n    _inheritsLoose(HorizontalVirtualScrolling, _VirtualScrollingBase2);\r\n\r\n    function HorizontalVirtualScrolling(options) {\r\n        return _VirtualScrollingBase2.call(this, {\r\n            workspace: options.workspace,\r\n            viewportSize: options.viewportWidth,\r\n            itemSize: options.cellWidth\r\n        }) || this\r\n    }\r\n    var _proto4 = HorizontalVirtualScrolling.prototype;\r\n    _proto4.getTotalItemCount = function() {\r\n        return this.workspace._getTotalCellCount(this.groupCount, this.isVerticalGrouping)\r\n    };\r\n    _proto4.getRenderState = function() {\r\n        return {\r\n            leftVirtualCellWidth: this.state.virtualItemSizeBefore,\r\n            rightVirtualCellWidth: this.state.virtualItemSizeAfter,\r\n            startCellIndex: this.state.startIndex,\r\n            cellCount: this.state.itemCount,\r\n            cellWidth: this.state.itemSize\r\n        }\r\n    };\r\n    return HorizontalVirtualScrolling\r\n}(VirtualScrollingBase);\r\nvar Renderer = function() {\r\n    function Renderer(workspace) {\r\n        this._workspace = workspace;\r\n        this._renderAppointmentTimeout = null\r\n    }\r\n    var _proto5 = Renderer.prototype;\r\n    _proto5.getRenderTimeout = function() {\r\n        return VIRTUAL_APPOINTMENTS_RENDER_TIMEOUT\r\n    };\r\n    _proto5.updateRender = function() {\r\n        this._renderDateTable();\r\n        this._renderAppointments()\r\n    };\r\n    _proto5._renderDateTable = function() {\r\n        this.workspace.renderRWorkspace(false)\r\n    };\r\n    _proto5._renderAppointments = function() {\r\n        var _this3 = this;\r\n        var renderTimeout = this.getRenderTimeout();\r\n        if (renderTimeout >= 0) {\r\n            clearTimeout(this._renderAppointmentTimeout);\r\n            this._renderAppointmentTimeout = setTimeout(function() {\r\n                return _this3.workspace.updateAppointments()\r\n            }, renderTimeout)\r\n        } else {\r\n            this.workspace.updateAppointments()\r\n        }\r\n    };\r\n    _createClass(Renderer, [{\r\n        key: \"workspace\",\r\n        get: function() {\r\n            return this._workspace\r\n        }\r\n    }]);\r\n    return Renderer\r\n}();\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}