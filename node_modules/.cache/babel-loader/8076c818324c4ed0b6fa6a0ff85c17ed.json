{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiSchedulerAppointmentsStrategy = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\"));\n\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\"));\n\nvar _uiSchedulerAppointmentsStrategy3 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\"));\n\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\"));\n\nvar _uiSchedulerAppointmentsStrategy5 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar RENDERING_STRATEGIES = {\n  horizontal: _uiSchedulerAppointmentsStrategy2.default,\n  horizontalMonth: _uiSchedulerAppointmentsStrategy4.default,\n  horizontalMonthLine: _uiSchedulerAppointmentsStrategy3.default,\n  vertical: _uiSchedulerAppointmentsStrategy.default,\n  agenda: _uiSchedulerAppointmentsStrategy5.default\n};\n\nvar AppointmentLayoutManager = function () {\n  function AppointmentLayoutManager(instance, renderingStrategy) {\n    this.instance = instance;\n    renderingStrategy && this.initRenderingStrategy(renderingStrategy);\n  }\n\n  var _proto = AppointmentLayoutManager.prototype;\n\n  _proto.getCellDimensions = function (options) {\n    if (this.instance._workSpace) {\n      return {\n        width: this.instance._workSpace.getCellWidth(),\n        height: this.instance._workSpace.getCellHeight(),\n        allDayHeight: this.instance._workSpace.getAllDayHeight()\n      };\n    }\n  };\n\n  _proto.getGroupOrientation = function (options) {\n    if (this.instance._workSpace) {\n      options.callback(this.instance._workSpace._getRealGroupOrientation());\n    }\n  };\n\n  _proto.initRenderingStrategy = function (renderingStrategy) {\n    var Strategy = RENDERING_STRATEGIES[renderingStrategy];\n    this._renderingStrategyInstance = new Strategy(this.instance);\n    this.renderingStrategy = renderingStrategy;\n  };\n\n  _proto.createAppointmentsMap = function (items) {\n    var _this = this;\n\n    var _this$getCellDimensio = this.getCellDimensions(),\n        allDayHeight = _this$getCellDimensio.allDayHeight;\n\n    this.instance._allDayCellHeight = allDayHeight;\n    this.getGroupOrientation({\n      callback: function (groupOrientation) {\n        return _this.instance._groupOrientation = groupOrientation;\n      }\n    });\n    var appointments = items ? items.slice() : [];\n    this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(appointments);\n    return this._createAppointmentsMapCore(appointments, this._positionMap);\n  };\n\n  _proto._createAppointmentsMapCore = function (list, positionMap) {\n    var _this2 = this;\n\n    return list.map(function (data, index) {\n      if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\n        delete data.settings;\n      }\n\n      var appointmentSettings = positionMap[index];\n      appointmentSettings.forEach(function (settings) {\n        settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\";\n      });\n      return {\n        itemData: data,\n        settings: appointmentSettings,\n        needRepaint: true,\n        needRemove: false\n      };\n    });\n  };\n\n  _proto._isDataChanged = function (data) {\n    var updatedData = this.instance.getUpdatedAppointment();\n    return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function (item) {\n      return data[item.key] === item.value;\n    });\n  };\n\n  _proto._isAppointmentShouldAppear = function (currentAppointment, sourceAppointment) {\n    return currentAppointment.needRepaint && sourceAppointment.needRemove;\n  };\n\n  _proto._isSettingChanged = function (settings, sourceSetting) {\n    if (settings.length !== sourceSetting.length) {\n      return true;\n    }\n\n    for (var i = 0; i < settings.length; i++) {\n      var newSettings = settings[i];\n      var oldSettings = sourceSetting[i];\n\n      if (oldSettings) {\n        oldSettings.sortedIndex = newSettings.sortedIndex;\n      }\n\n      if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  _proto._getAssociatedSourceAppointment = function (currentAppointment, sourceAppointments) {\n    for (var i = 0; i < sourceAppointments.length; i++) {\n      var item = sourceAppointments[i];\n\n      if (item.itemData === currentAppointment.itemData) {\n        return item;\n      }\n    }\n\n    return null;\n  };\n\n  _proto._getDeletedAppointments = function (currentAppointments, sourceAppointments) {\n    var result = [];\n\n    for (var i = 0; i < sourceAppointments.length; i++) {\n      var sourceAppointment = sourceAppointments[i];\n\n      var currentAppointment = this._getAssociatedSourceAppointment(sourceAppointment, currentAppointments);\n\n      if (!currentAppointment) {\n        sourceAppointment.needRemove = true;\n        result.push(sourceAppointment);\n      }\n    }\n\n    return result;\n  };\n\n  _proto.getRepaintedAppointments = function (currentAppointments, sourceAppointments) {\n    var _this3 = this;\n\n    if (0 === sourceAppointments.length || \"agenda\" === this.renderingStrategy) {\n      return currentAppointments;\n    }\n\n    currentAppointments.forEach(function (appointment) {\n      var sourceAppointment = _this3._getAssociatedSourceAppointment(appointment, sourceAppointments);\n\n      if (sourceAppointment) {\n        appointment.needRepaint = _this3._isDataChanged(appointment.itemData) || _this3._isSettingChanged(appointment.settings, sourceAppointment.settings) || _this3._isAppointmentShouldAppear(appointment, sourceAppointment);\n      }\n    });\n    return currentAppointments.concat(this._getDeletedAppointments(currentAppointments, sourceAppointments));\n  };\n\n  _proto.getRenderingStrategyInstance = function () {\n    return this._renderingStrategyInstance;\n  };\n\n  return AppointmentLayoutManager;\n}();\n\nvar _default = AppointmentLayoutManager;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["/home/emma/node_modules/devextreme/ui/scheduler/ui.scheduler.appointments.layout_manager.js"],"names":["exports","default","_common","require","_uiSchedulerAppointmentsStrategy","_interopRequireDefault","_uiSchedulerAppointmentsStrategy2","_uiSchedulerAppointmentsStrategy3","_uiSchedulerAppointmentsStrategy4","_uiSchedulerAppointmentsStrategy5","obj","__esModule","RENDERING_STRATEGIES","horizontal","horizontalMonth","horizontalMonthLine","vertical","agenda","AppointmentLayoutManager","instance","renderingStrategy","initRenderingStrategy","_proto","prototype","getCellDimensions","options","_workSpace","width","getCellWidth","height","getCellHeight","allDayHeight","getAllDayHeight","getGroupOrientation","callback","_getRealGroupOrientation","Strategy","_renderingStrategyInstance","createAppointmentsMap","items","_this","_this$getCellDimensio","_allDayCellHeight","groupOrientation","_groupOrientation","appointments","slice","_positionMap","createTaskPositionMap","_createAppointmentsMapCore","list","positionMap","_this2","map","data","index","keepAppointmentSettings","settings","appointmentSettings","forEach","direction","allDay","itemData","needRepaint","needRemove","_isDataChanged","updatedData","getUpdatedAppointment","getUpdatedAppointmentKeys","some","item","key","value","_isAppointmentShouldAppear","currentAppointment","sourceAppointment","_isSettingChanged","sourceSetting","length","i","newSettings","oldSettings","sortedIndex","equalByValue","_getAssociatedSourceAppointment","sourceAppointments","_getDeletedAppointments","currentAppointments","result","push","getRepaintedAppointments","_this3","appointment","concat","getRenderingStrategyInstance","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiSchedulerAppointmentsStrategy = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\"));\r\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\"));\r\nvar _uiSchedulerAppointmentsStrategy3 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\"));\r\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\"));\r\nvar _uiSchedulerAppointmentsStrategy5 = _interopRequireDefault(require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar RENDERING_STRATEGIES = {\r\n    horizontal: _uiSchedulerAppointmentsStrategy2.default,\r\n    horizontalMonth: _uiSchedulerAppointmentsStrategy4.default,\r\n    horizontalMonthLine: _uiSchedulerAppointmentsStrategy3.default,\r\n    vertical: _uiSchedulerAppointmentsStrategy.default,\r\n    agenda: _uiSchedulerAppointmentsStrategy5.default\r\n};\r\nvar AppointmentLayoutManager = function() {\r\n    function AppointmentLayoutManager(instance, renderingStrategy) {\r\n        this.instance = instance;\r\n        renderingStrategy && this.initRenderingStrategy(renderingStrategy)\r\n    }\r\n    var _proto = AppointmentLayoutManager.prototype;\r\n    _proto.getCellDimensions = function(options) {\r\n        if (this.instance._workSpace) {\r\n            return {\r\n                width: this.instance._workSpace.getCellWidth(),\r\n                height: this.instance._workSpace.getCellHeight(),\r\n                allDayHeight: this.instance._workSpace.getAllDayHeight()\r\n            }\r\n        }\r\n    };\r\n    _proto.getGroupOrientation = function(options) {\r\n        if (this.instance._workSpace) {\r\n            options.callback(this.instance._workSpace._getRealGroupOrientation())\r\n        }\r\n    };\r\n    _proto.initRenderingStrategy = function(renderingStrategy) {\r\n        var Strategy = RENDERING_STRATEGIES[renderingStrategy];\r\n        this._renderingStrategyInstance = new Strategy(this.instance);\r\n        this.renderingStrategy = renderingStrategy\r\n    };\r\n    _proto.createAppointmentsMap = function(items) {\r\n        var _this = this;\r\n        var _this$getCellDimensio = this.getCellDimensions(),\r\n            allDayHeight = _this$getCellDimensio.allDayHeight;\r\n        this.instance._allDayCellHeight = allDayHeight;\r\n        this.getGroupOrientation({\r\n            callback: function(groupOrientation) {\r\n                return _this.instance._groupOrientation = groupOrientation\r\n            }\r\n        });\r\n        var appointments = items ? items.slice() : [];\r\n        this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(appointments);\r\n        return this._createAppointmentsMapCore(appointments, this._positionMap)\r\n    };\r\n    _proto._createAppointmentsMapCore = function(list, positionMap) {\r\n        var _this2 = this;\r\n        return list.map(function(data, index) {\r\n            if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\r\n                delete data.settings\r\n            }\r\n            var appointmentSettings = positionMap[index];\r\n            appointmentSettings.forEach(function(settings) {\r\n                settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\"\r\n            });\r\n            return {\r\n                itemData: data,\r\n                settings: appointmentSettings,\r\n                needRepaint: true,\r\n                needRemove: false\r\n            }\r\n        })\r\n    };\r\n    _proto._isDataChanged = function(data) {\r\n        var updatedData = this.instance.getUpdatedAppointment();\r\n        return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function(item) {\r\n            return data[item.key] === item.value\r\n        })\r\n    };\r\n    _proto._isAppointmentShouldAppear = function(currentAppointment, sourceAppointment) {\r\n        return currentAppointment.needRepaint && sourceAppointment.needRemove\r\n    };\r\n    _proto._isSettingChanged = function(settings, sourceSetting) {\r\n        if (settings.length !== sourceSetting.length) {\r\n            return true\r\n        }\r\n        for (var i = 0; i < settings.length; i++) {\r\n            var newSettings = settings[i];\r\n            var oldSettings = sourceSetting[i];\r\n            if (oldSettings) {\r\n                oldSettings.sortedIndex = newSettings.sortedIndex\r\n            }\r\n            if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\r\n                return true\r\n            }\r\n        }\r\n        return false\r\n    };\r\n    _proto._getAssociatedSourceAppointment = function(currentAppointment, sourceAppointments) {\r\n        for (var i = 0; i < sourceAppointments.length; i++) {\r\n            var item = sourceAppointments[i];\r\n            if (item.itemData === currentAppointment.itemData) {\r\n                return item\r\n            }\r\n        }\r\n        return null\r\n    };\r\n    _proto._getDeletedAppointments = function(currentAppointments, sourceAppointments) {\r\n        var result = [];\r\n        for (var i = 0; i < sourceAppointments.length; i++) {\r\n            var sourceAppointment = sourceAppointments[i];\r\n            var currentAppointment = this._getAssociatedSourceAppointment(sourceAppointment, currentAppointments);\r\n            if (!currentAppointment) {\r\n                sourceAppointment.needRemove = true;\r\n                result.push(sourceAppointment)\r\n            }\r\n        }\r\n        return result\r\n    };\r\n    _proto.getRepaintedAppointments = function(currentAppointments, sourceAppointments) {\r\n        var _this3 = this;\r\n        if (0 === sourceAppointments.length || \"agenda\" === this.renderingStrategy) {\r\n            return currentAppointments\r\n        }\r\n        currentAppointments.forEach(function(appointment) {\r\n            var sourceAppointment = _this3._getAssociatedSourceAppointment(appointment, sourceAppointments);\r\n            if (sourceAppointment) {\r\n                appointment.needRepaint = _this3._isDataChanged(appointment.itemData) || _this3._isSettingChanged(appointment.settings, sourceAppointment.settings) || _this3._isAppointmentShouldAppear(appointment, sourceAppointment)\r\n            }\r\n        });\r\n        return currentAppointments.concat(this._getDeletedAppointments(currentAppointments, sourceAppointments))\r\n    };\r\n    _proto.getRenderingStrategyInstance = function() {\r\n        return this._renderingStrategyInstance\r\n    };\r\n    return AppointmentLayoutManager\r\n}();\r\nvar _default = AppointmentLayoutManager;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}