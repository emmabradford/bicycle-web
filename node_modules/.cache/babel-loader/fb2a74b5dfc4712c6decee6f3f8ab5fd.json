{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/view_data_provider.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _date = _interopRequireDefault(require(\"../../../core/utils/date\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else {\n      if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (\"undefined\" !== typeof Symbol && null != iter[Symbol.iterator] || null != iter[\"@@iterator\"]) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    return _arrayLikeToArray(arr);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar ViewDataGenerator = function () {\n  function ViewDataGenerator(workspace) {\n    this.workspace = workspace;\n  }\n\n  var _proto = ViewDataGenerator.prototype;\n\n  _proto._getCompleteViewDataMap = function (options) {\n    var rowCount = options.nonVirtualRowCount,\n        cellCount = options.cellCount,\n        verticalGroupCount = options.verticalGroupCount;\n    var viewDataMap = [];\n\n    for (var groupIndex = 0; groupIndex < verticalGroupCount; groupIndex += 1) {\n      var allDayPanelData = this._generateAllDayPanelData(options, groupIndex, rowCount, cellCount);\n\n      var viewCellsData = this._generateViewCellsData(options, rowCount, 0, rowCount * groupIndex);\n\n      allDayPanelData && viewDataMap.push(allDayPanelData);\n      viewDataMap.push.apply(viewDataMap, _toConsumableArray(viewCellsData));\n    }\n\n    return viewDataMap;\n  };\n\n  _proto._generateViewDataMap = function (completeViewDataMap, options) {\n    var startRowIndex = options.startRowIndex,\n        rowCount = options.rowCount;\n\n    var isVerticalGrouping = this.workspace._isVerticalGroupedWorkSpace();\n\n    var showAllDayPanel = this.workspace._isShowAllDayPanel();\n\n    var indexDifference = isVerticalGrouping || !showAllDayPanel ? 0 : 1;\n    var correctedStartRowIndex = startRowIndex + indexDifference;\n    return completeViewDataMap.slice(correctedStartRowIndex, correctedStartRowIndex + rowCount).map(function (cellsRow, rowIndex) {\n      return cellsRow.map(function (cellData, cellIndex) {\n        return {\n          cellData: cellData,\n          position: {\n            rowIndex: rowIndex,\n            cellIndex: cellIndex\n          }\n        };\n      });\n    });\n  };\n\n  _proto._getViewDataFromMap = function (viewDataMap, completeViewDataMap, options) {\n    var topVirtualRowHeight = options.topVirtualRowHeight,\n        bottomVirtualRowHeight = options.bottomVirtualRowHeight,\n        cellCountInGroupRow = options.cellCountInGroupRow;\n    var isGroupedAllDayPanel = this.workspace.isGroupedAllDayPanel();\n\n    var _viewDataMap$reduce = viewDataMap.reduce(function (_ref, cellsRow) {\n      var previousGroupIndex = _ref.previousGroupIndex,\n          previousGroupedData = _ref.previousGroupedData;\n      var cellDataRow = cellsRow.map(function (_ref2) {\n        var cellData = _ref2.cellData;\n        return cellData;\n      });\n      var firstCell = cellDataRow[0];\n      var isAllDayRow = firstCell.allDay;\n      var currentGroupIndex = firstCell.groupIndex;\n\n      if (currentGroupIndex !== previousGroupIndex) {\n        previousGroupedData.push({\n          dateTable: [],\n          isGroupedAllDayPanel: isGroupedAllDayPanel,\n          groupIndex: currentGroupIndex\n        });\n      }\n\n      if (isAllDayRow) {\n        previousGroupedData[previousGroupedData.length - 1].allDayPanel = cellDataRow;\n      } else {\n        previousGroupedData[previousGroupedData.length - 1].dateTable.push(cellDataRow);\n      }\n\n      return {\n        previousGroupedData: previousGroupedData,\n        previousGroupIndex: currentGroupIndex\n      };\n    }, {\n      previousGroupIndex: -1,\n      previousGroupedData: []\n    }),\n        groupedData = _viewDataMap$reduce.previousGroupedData;\n\n    var isVirtualScrolling = this.workspace.isVirtualScrolling();\n\n    var isVerticalGrouping = this.workspace._isVerticalGroupedWorkSpace();\n\n    var showAllDayPanel = this.workspace._isShowAllDayPanel();\n\n    if (!isVerticalGrouping && showAllDayPanel) {\n      groupedData[0].allDayPanel = completeViewDataMap[0];\n    }\n\n    return {\n      groupedData: groupedData,\n      isVirtual: isVirtualScrolling,\n      topVirtualRowHeight: topVirtualRowHeight,\n      bottomVirtualRowHeight: bottomVirtualRowHeight,\n      cellCountInGroupRow: cellCountInGroupRow\n    };\n  };\n\n  _proto._generateViewCellsData = function (options, renderRowCount, startRowIndex, rowOffset) {\n    var cellCount = options.cellCount,\n        cellDataGetters = options.cellDataGetters,\n        rowCountInGroup = options.rowCountInGroup;\n    var viewCellsData = [];\n\n    for (var i = 0; i < renderRowCount; ++i) {\n      var rowIndex = startRowIndex + rowOffset + i;\n      var rowIndexInGroup = rowIndex % rowCountInGroup;\n      viewCellsData.push(this._generateCellsRow(options, cellDataGetters, rowIndex, cellCount, rowIndexInGroup));\n    }\n\n    return viewCellsData;\n  };\n\n  _proto._generateAllDayPanelData = function (options, groupIndex, rowCount, cellCount) {\n    var workSpace = this.workspace;\n\n    if (!workSpace._isShowAllDayPanel()) {\n      return null;\n    }\n\n    var rowIndex = Math.max(groupIndex * rowCount, 0);\n    return this._generateCellsRow(options, [workSpace._getAllDayCellData.bind(workSpace)], rowIndex, cellCount, 0, groupIndex);\n  };\n\n  _proto._generateCellsRow = function (options, cellDataGetters, rowIndex, cellCount, rowIndexInGroup, groupIndex) {\n    var _this = this;\n\n    var cellsRow = [];\n    var horizontalGroupCount = options.horizontalGroupCount,\n        groupOrientation = options.groupOrientation,\n        rowCountInGroup = options.rowCountInGroup,\n        cellCountInGroupRow = options.cellCountInGroupRow,\n        groupCount = options.groupCount;\n\n    var _loop = function (columnIndex) {\n      var cellDataValue = cellDataGetters.reduce(function (data, getter) {\n        return _objectSpread(_objectSpread({}, data), getter(void 0, rowIndex, columnIndex, groupIndex).value);\n      }, {});\n      cellDataValue.index = _this._calculateCellIndex(horizontalGroupCount, groupOrientation, _this._workspace.isGroupedByDate(), rowIndexInGroup, columnIndex, cellCount);\n      cellDataValue.isFirstGroupCell = _this._isFirstGroupCell(rowIndex, columnIndex, rowCountInGroup, cellCountInGroupRow, groupCount);\n      cellDataValue.isLastGroupCell = _this._isLastGroupCell(rowIndex, columnIndex, rowCountInGroup, cellCountInGroupRow, groupCount);\n      cellDataValue.key = _this._getKeyByRowAndColumn(rowIndex, columnIndex, cellCount);\n      cellsRow.push(cellDataValue);\n    };\n\n    for (var columnIndex = 0; columnIndex < cellCount; ++columnIndex) {\n      _loop(columnIndex);\n    }\n\n    return cellsRow;\n  };\n\n  _proto._calculateCellIndex = function (horizontalGroupCount, groupOrientation, isGroupedByDate, rowIndex, columnIndex, columnsNumber) {\n    var groupCount = horizontalGroupCount || 1;\n    var index = rowIndex * columnsNumber + columnIndex;\n    var columnsInGroup = columnsNumber / groupCount;\n\n    if (\"horizontal\" === groupOrientation) {\n      var columnIndexInCurrentGroup = columnIndex % columnsInGroup;\n\n      if (isGroupedByDate) {\n        columnIndexInCurrentGroup = Math.floor(columnIndex / groupCount);\n      }\n\n      index = rowIndex * columnsInGroup + columnIndexInCurrentGroup;\n    }\n\n    return index;\n  };\n\n  _proto._getKeyByRowAndColumn = function (rowIndex, columnIndex, cellCount) {\n    return rowIndex * cellCount + columnIndex;\n  };\n\n  _proto.generateGroupedDataMap = function (viewDataMap) {\n    var _viewDataMap$reduce2 = viewDataMap.reduce(function (previousOptions, cellsRow) {\n      var previousGroupedDataMap = previousOptions.previousGroupedDataMap,\n          previousRowIndex = previousOptions.previousRowIndex,\n          previousGroupIndex = previousOptions.previousGroupIndex;\n      var currentGroupIndex = cellsRow[0].cellData.groupIndex;\n      var currentRowIndex = currentGroupIndex === previousGroupIndex ? previousRowIndex + 1 : 0;\n      cellsRow.forEach(function (cell) {\n        var groupIndex = cell.cellData.groupIndex;\n\n        if (!previousGroupedDataMap[groupIndex]) {\n          previousGroupedDataMap[groupIndex] = [];\n        }\n\n        if (!previousGroupedDataMap[groupIndex][currentRowIndex]) {\n          previousGroupedDataMap[groupIndex][currentRowIndex] = [];\n        }\n\n        previousGroupedDataMap[groupIndex][currentRowIndex].push(cell);\n      });\n      return {\n        previousGroupedDataMap: previousGroupedDataMap,\n        previousRowIndex: currentRowIndex,\n        previousGroupIndex: currentGroupIndex\n      };\n    }, {\n      previousGroupedDataMap: [],\n      previousRowIndex: -1,\n      previousGroupIndex: -1\n    }),\n        groupedDataMap = _viewDataMap$reduce2.previousGroupedDataMap;\n\n    return groupedDataMap;\n  };\n\n  _proto._isFirstGroupCell = function (rowIndex, columnIndex, singleGroupRowCount, singleGroupColumnCount, groupCount) {\n    if (this.workspace.isGroupedByDate()) {\n      return columnIndex % groupCount === 0;\n    }\n\n    if (this.workspace._isHorizontalGroupedWorkSpace() || 0 === groupCount) {\n      return columnIndex % singleGroupColumnCount === 0;\n    }\n\n    return rowIndex % singleGroupRowCount === 0;\n  };\n\n  _proto._isLastGroupCell = function (rowIndex, columnIndex, singleGroupRowCount, singleGroupColumnCount, groupCount) {\n    if (this.workspace.isGroupedByDate()) {\n      return (columnIndex + 1) % groupCount === 0;\n    }\n\n    if (this.workspace._isHorizontalGroupedWorkSpace() || 0 === groupCount) {\n      return (columnIndex + 1) % singleGroupColumnCount === 0;\n    }\n\n    return (rowIndex + 1) % singleGroupRowCount === 0;\n  };\n\n  _createClass(ViewDataGenerator, [{\n    key: \"workspace\",\n    get: function () {\n      return this._workspace;\n    },\n    set: function (value) {\n      this._workspace = value;\n    }\n  }]);\n\n  return ViewDataGenerator;\n}();\n\nvar ViewDataProvider = function () {\n  function ViewDataProvider(workspace) {\n    this._viewDataGenerator = null;\n    this._viewData = [];\n    this._completeViewDataMap = [];\n    this._completeGroupedViewDataMap = [];\n    this._viewDataMap = [];\n    this._groupedDataMap = [];\n    this._workspace = workspace;\n  }\n\n  var _proto2 = ViewDataProvider.prototype;\n\n  _proto2.update = function (isGenerateNewViewData) {\n    var viewDataGenerator = this.viewDataGenerator,\n        _workspace = this._workspace;\n\n    var renderOptions = _workspace.generateRenderOptions();\n\n    if (isGenerateNewViewData) {\n      this.completeViewDataMap = viewDataGenerator._getCompleteViewDataMap(renderOptions);\n    }\n\n    this.viewDataMap = viewDataGenerator._generateViewDataMap(this.completeViewDataMap, renderOptions);\n    this.viewData = viewDataGenerator._getViewDataFromMap(this.viewDataMap, this.completeViewDataMap, renderOptions);\n    this.groupedDataMap = viewDataGenerator.generateGroupedDataMap(this.viewDataMap);\n  };\n\n  _proto2.getStartDate = function () {\n    var groupedData = this.viewData.groupedData;\n    var dateTable = groupedData[0].dateTable;\n    return dateTable[0][0].startDate;\n  };\n\n  _proto2.getGroupStartDate = function (groupIndex) {\n    var _this$getGroupData = this.getGroupData(groupIndex),\n        dateTable = _this$getGroupData.dateTable;\n\n    return dateTable[0][0].startDate;\n  };\n\n  _proto2.getGroupEndDate = function (groupIndex) {\n    var _this$getGroupData2 = this.getGroupData(groupIndex),\n        dateTable = _this$getGroupData2.dateTable;\n\n    var lastRowIndex = dateTable.length - 1;\n    var lastCellIndex = dateTable[lastRowIndex].length - 1;\n    return dateTable[lastRowIndex][lastCellIndex].endDate;\n  };\n\n  _proto2.findGroupCellStartDate = function (groupIndex, startDate, endDate, isAllDay) {\n    if (isAllDay) {\n      return this.findAllDayGroupCellStartDate(groupIndex, startDate);\n    }\n\n    var _this$getGroupData3 = this.getGroupData(groupIndex),\n        dateTable = _this$getGroupData3.dateTable;\n\n    if (!dateTable.length) {\n      return;\n    }\n\n    for (var i = 0; i < dateTable[0].length; ++i) {\n      var cell = dateTable[0][i];\n      var lastRowIndex = dateTable.length - 1;\n\n      if (_date.default.sameDate(cell.startDate, startDate)) {\n        var _lastCell;\n\n        var lastCell = dateTable[lastRowIndex][i];\n\n        if (lastCell.endDate <= startDate) {\n          if (endDate.getDate() > startDate.getDate()) {\n            cell = dateTable[0][i + 1];\n            lastCell = dateTable[lastRowIndex][i + 1];\n          }\n        }\n\n        if ((null === (_lastCell = lastCell) || void 0 === _lastCell ? void 0 : _lastCell.endDate) > startDate) {\n          return cell.startDate;\n        }\n      }\n    }\n  };\n\n  _proto2.findAllDayGroupCellStartDate = function (groupIndex, startDate) {\n    var groupStartDate = this.getGroupStartDate(groupIndex);\n    return groupStartDate > startDate ? groupStartDate : startDate;\n  };\n\n  _proto2.getCellsGroup = function (groupIndex) {\n    var _this$getGroupData4 = this.getGroupData(groupIndex),\n        dateTable = _this$getGroupData4.dateTable;\n\n    return dateTable[0][0].groups;\n  };\n\n  _proto2.getCellData = function (rowIndex, cellIndex, isAllDay) {\n    if (isAllDay && !this._workspace._isVerticalGroupedWorkSpace()) {\n      return this._viewData.groupedData[0].allDayPanel[cellIndex];\n    }\n\n    var cellData = this.viewDataMap[rowIndex][cellIndex].cellData;\n    return cellData;\n  };\n\n  _proto2.getCellsByGroupIndexAndAllDay = function (groupIndex, allDay) {\n    var workspace = this._workspace;\n\n    var rowsPerGroup = workspace._getRowCountWithAllDayRows();\n\n    var isVerticalGrouping = workspace._isVerticalGroupedWorkSpace();\n\n    var isShowAllDayPanel = workspace._isShowAllDayPanel();\n\n    var firstRowInGroup = isVerticalGrouping ? groupIndex * rowsPerGroup : 0;\n    var lastRowInGroup = isVerticalGrouping ? (groupIndex + 1) * rowsPerGroup - 1 : rowsPerGroup;\n    var correctedFirstRow = isShowAllDayPanel && !allDay ? firstRowInGroup + 1 : firstRowInGroup;\n    var correctedLastRow = allDay ? correctedFirstRow : lastRowInGroup;\n    return this.completeViewDataMap.slice(correctedFirstRow, correctedLastRow + 1).map(function (row) {\n      return row.filter(function (_ref3) {\n        var currentGroupIndex = _ref3.groupIndex;\n        return groupIndex === currentGroupIndex;\n      });\n    });\n  };\n\n  _proto2.findCellPositionInMap = function (groupIndex, startDate, isAllDay) {\n    var startTime = isAllDay ? _date.default.trimTime(startDate).getTime() : startDate.getTime();\n\n    var isStartTimeInCell = function (cellData) {\n      var cellStartTime = cellData.startDate.getTime();\n      var cellEndTime = cellData.endDate.getTime();\n      return isAllDay ? cellData.allDay && startTime >= cellStartTime && startTime <= cellEndTime : startTime >= cellStartTime && startTime < cellEndTime;\n    };\n\n    var rows = isAllDay && !this._workspace._isVerticalGroupedWorkSpace() ? [this.completeViewDataMap[0].map(function (cell, index) {\n      return {\n        cellData: cell,\n        position: {\n          cellIndex: index,\n          rowIndex: 0\n        }\n      };\n    })] : this.groupedDataMap[groupIndex] || [];\n\n    for (var rowIndex = 0; rowIndex < rows.length; ++rowIndex) {\n      var row = rows[rowIndex];\n\n      for (var cellIndex = 0; cellIndex < row.length; ++cellIndex) {\n        var cell = row[cellIndex];\n        var cellData = cell.cellData;\n\n        if (cellData.groupIndex === groupIndex) {\n          if (isStartTimeInCell(cellData)) {\n            return cell.position;\n          }\n        }\n      }\n    }\n\n    return;\n  };\n\n  _proto2.getGroupIndices = function () {\n    var groupedData = this.viewData.groupedData;\n    return groupedData.map(function (_ref4) {\n      var groupIndex = _ref4.groupIndex;\n      return groupIndex;\n    });\n  };\n\n  _proto2._getLastGroupRow = function (groupIndex) {\n    var group = this.groupedDataMap[groupIndex];\n    var lastIndex = group.length - 1;\n    return group[lastIndex];\n  };\n\n  _proto2.getLasGroupCellPosition = function (groupIndex) {\n    var groupRow = this._getLastGroupRow(groupIndex);\n\n    return groupRow[0].position;\n  };\n\n  _proto2.getLasGroupCellIndex = function (groupIndex) {\n    var group = this.groupedDataMap[groupIndex];\n    return group.length - 1;\n  };\n\n  _proto2.getRowCountInGroup = function (groupIndex) {\n    var groupRow = this._getLastGroupRow(groupIndex);\n\n    var cellAmount = groupRow.length;\n    var lastCellData = groupRow[cellAmount - 1].cellData;\n    var lastCellIndex = lastCellData.index;\n    return (lastCellIndex + 1) / groupRow.length;\n  };\n\n  _proto2.getGroupData = function (groupIndex) {\n    var groupedData = this.viewData.groupedData;\n    return groupedData.filter(function (item) {\n      return item.groupIndex === groupIndex;\n    })[0];\n  };\n\n  _proto2.isGroupIntersectDateInterval = function (groupIndex, startDate, endDate) {\n    var groupStartDate = this.getGroupStartDate(groupIndex);\n    var groupEndDate = this.getGroupEndDate(groupIndex);\n    return startDate < groupEndDate && endDate > groupStartDate;\n  };\n\n  _proto2.findGlobalCellPosition = function (date) {\n    var groupIndex = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;\n    var allDay = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : false;\n    var completeViewDataMap = this.completeViewDataMap,\n        workspace = this._workspace;\n\n    var showAllDayPanel = workspace._isShowAllDayPanel();\n\n    var isVerticalGroupOrientation = workspace._isVerticalGroupedWorkSpace();\n\n    for (var rowIndex = 0; rowIndex < completeViewDataMap.length; rowIndex += 1) {\n      var currentRow = completeViewDataMap[rowIndex];\n\n      for (var columnIndex = 0; columnIndex < currentRow.length; columnIndex += 1) {\n        var cellData = currentRow[columnIndex];\n        var currentStartDate = cellData.startDate,\n            currentEndDate = cellData.endDate,\n            currentGroupIndex = cellData.groupIndex,\n            currentAllDay = cellData.allDay;\n\n        if (groupIndex === currentGroupIndex && allDay === currentAllDay && this._compareDatesAndAllDay(date, currentStartDate, currentEndDate, allDay)) {\n          return {\n            position: {\n              columnIndex: columnIndex,\n              rowIndex: showAllDayPanel && !isVerticalGroupOrientation ? rowIndex - 1 : rowIndex\n            },\n            cellData: cellData\n          };\n        }\n      }\n    }\n  };\n\n  _proto2._compareDatesAndAllDay = function (date, cellStartDate, cellEndDate, allDay) {\n    var time = date.getTime();\n\n    var trimmedTime = _date.default.trimTime(date).getTime();\n\n    var cellStartTime = cellStartDate.getTime();\n    var cellEndTime = cellEndDate.getTime();\n    return !allDay && time >= cellStartTime && time < cellEndTime || allDay && trimmedTime === cellStartTime;\n  };\n\n  _createClass(ViewDataProvider, [{\n    key: \"viewDataGenerator\",\n    get: function () {\n      if (!this._viewDataGenerator) {\n        this._viewDataGenerator = new ViewDataGenerator(this._workspace);\n      }\n\n      return this._viewDataGenerator;\n    }\n  }, {\n    key: \"completeViewDataMap\",\n    get: function () {\n      return this._completeViewDataMap;\n    },\n    set: function (value) {\n      this._completeViewDataMap = value;\n    }\n  }, {\n    key: \"completeGroupedViewDataMap\",\n    get: function () {\n      return this._completeGroupedViewDataMap;\n    },\n    set: function (value) {\n      this._completeGroupedViewDataMap = value;\n    }\n  }, {\n    key: \"viewData\",\n    get: function () {\n      return this._viewData;\n    },\n    set: function (value) {\n      this._viewData = value;\n    }\n  }, {\n    key: \"viewDataMap\",\n    get: function () {\n      return this._viewDataMap;\n    },\n    set: function (value) {\n      this._viewDataMap = value;\n    }\n  }, {\n    key: \"groupedDataMap\",\n    get: function () {\n      return this._groupedDataMap;\n    },\n    set: function (value) {\n      this._groupedDataMap = value;\n    }\n  }]);\n\n  return ViewDataProvider;\n}();\n\nexports.default = ViewDataProvider;\nmodule.exports = exports.default;","map":{"version":3,"sources":["/home/emma/node_modules/devextreme/ui/scheduler/workspaces/view_data_provider.js"],"names":["exports","default","_date","_interopRequireDefault","require","obj","__esModule","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","ViewDataGenerator","workspace","_proto","_getCompleteViewDataMap","options","rowCount","nonVirtualRowCount","cellCount","verticalGroupCount","viewDataMap","groupIndex","allDayPanelData","_generateAllDayPanelData","viewCellsData","_generateViewCellsData","_generateViewDataMap","completeViewDataMap","startRowIndex","isVerticalGrouping","_isVerticalGroupedWorkSpace","showAllDayPanel","_isShowAllDayPanel","indexDifference","correctedStartRowIndex","map","cellsRow","rowIndex","cellData","cellIndex","position","_getViewDataFromMap","topVirtualRowHeight","bottomVirtualRowHeight","cellCountInGroupRow","isGroupedAllDayPanel","_viewDataMap$reduce","reduce","_ref","previousGroupIndex","previousGroupedData","cellDataRow","_ref2","firstCell","isAllDayRow","allDay","currentGroupIndex","dateTable","allDayPanel","groupedData","isVirtualScrolling","isVirtual","renderRowCount","rowOffset","cellDataGetters","rowCountInGroup","rowIndexInGroup","_generateCellsRow","workSpace","Math","max","_getAllDayCellData","bind","_this","horizontalGroupCount","groupOrientation","groupCount","_loop","columnIndex","cellDataValue","data","getter","index","_calculateCellIndex","_workspace","isGroupedByDate","isFirstGroupCell","_isFirstGroupCell","isLastGroupCell","_isLastGroupCell","_getKeyByRowAndColumn","columnsNumber","columnsInGroup","columnIndexInCurrentGroup","floor","generateGroupedDataMap","_viewDataMap$reduce2","previousOptions","previousGroupedDataMap","previousRowIndex","currentRowIndex","cell","groupedDataMap","singleGroupRowCount","singleGroupColumnCount","_isHorizontalGroupedWorkSpace","get","set","ViewDataProvider","_viewDataGenerator","_viewData","_completeViewDataMap","_completeGroupedViewDataMap","_viewDataMap","_groupedDataMap","_proto2","update","isGenerateNewViewData","viewDataGenerator","renderOptions","generateRenderOptions","viewData","getStartDate","startDate","getGroupStartDate","_this$getGroupData","getGroupData","getGroupEndDate","_this$getGroupData2","lastRowIndex","lastCellIndex","endDate","findGroupCellStartDate","isAllDay","findAllDayGroupCellStartDate","_this$getGroupData3","sameDate","_lastCell","lastCell","getDate","groupStartDate","getCellsGroup","_this$getGroupData4","groups","getCellData","getCellsByGroupIndexAndAllDay","rowsPerGroup","_getRowCountWithAllDayRows","isShowAllDayPanel","firstRowInGroup","lastRowInGroup","correctedFirstRow","correctedLastRow","row","_ref3","findCellPositionInMap","startTime","trimTime","getTime","isStartTimeInCell","cellStartTime","cellEndTime","rows","getGroupIndices","_ref4","_getLastGroupRow","group","lastIndex","getLasGroupCellPosition","groupRow","getLasGroupCellIndex","getRowCountInGroup","cellAmount","lastCellData","item","isGroupIntersectDateInterval","groupEndDate","findGlobalCellPosition","date","isVerticalGroupOrientation","currentRow","currentStartDate","currentEndDate","currentAllDay","_compareDatesAndAllDay","cellStartDate","cellEndDate","time","trimmedTime","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/view_data_provider.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _date = _interopRequireDefault(require(\"../../../core/utils/date\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n    var keys = Object.keys(object);\r\n    if (Object.getOwnPropertySymbols) {\r\n        var symbols = Object.getOwnPropertySymbols(object);\r\n        if (enumerableOnly) {\r\n            symbols = symbols.filter(function(sym) {\r\n                return Object.getOwnPropertyDescriptor(object, sym).enumerable\r\n            })\r\n        }\r\n        keys.push.apply(keys, symbols)\r\n    }\r\n    return keys\r\n}\r\n\r\nfunction _objectSpread(target) {\r\n    for (var i = 1; i < arguments.length; i++) {\r\n        var source = null != arguments[i] ? arguments[i] : {};\r\n        if (i % 2) {\r\n            ownKeys(Object(source), true).forEach(function(key) {\r\n                _defineProperty(target, key, source[key])\r\n            })\r\n        } else {\r\n            if (Object.getOwnPropertyDescriptors) {\r\n                Object.defineProperties(target, Object.getOwnPropertyDescriptors(source))\r\n            } else {\r\n                ownKeys(Object(source)).forEach(function(key) {\r\n                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key))\r\n                })\r\n            }\r\n        }\r\n    }\r\n    return target\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n    if (key in obj) {\r\n        Object.defineProperty(obj, key, {\r\n            value: value,\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true\r\n        })\r\n    } else {\r\n        obj[key] = value\r\n    }\r\n    return obj\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(o)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (\"undefined\" !== typeof Symbol && null != iter[Symbol.iterator] || null != iter[\"@@iterator\"]) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return _arrayLikeToArray(arr)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar ViewDataGenerator = function() {\r\n    function ViewDataGenerator(workspace) {\r\n        this.workspace = workspace\r\n    }\r\n    var _proto = ViewDataGenerator.prototype;\r\n    _proto._getCompleteViewDataMap = function(options) {\r\n        var rowCount = options.nonVirtualRowCount,\r\n            cellCount = options.cellCount,\r\n            verticalGroupCount = options.verticalGroupCount;\r\n        var viewDataMap = [];\r\n        for (var groupIndex = 0; groupIndex < verticalGroupCount; groupIndex += 1) {\r\n            var allDayPanelData = this._generateAllDayPanelData(options, groupIndex, rowCount, cellCount);\r\n            var viewCellsData = this._generateViewCellsData(options, rowCount, 0, rowCount * groupIndex);\r\n            allDayPanelData && viewDataMap.push(allDayPanelData);\r\n            viewDataMap.push.apply(viewDataMap, _toConsumableArray(viewCellsData))\r\n        }\r\n        return viewDataMap\r\n    };\r\n    _proto._generateViewDataMap = function(completeViewDataMap, options) {\r\n        var startRowIndex = options.startRowIndex,\r\n            rowCount = options.rowCount;\r\n        var isVerticalGrouping = this.workspace._isVerticalGroupedWorkSpace();\r\n        var showAllDayPanel = this.workspace._isShowAllDayPanel();\r\n        var indexDifference = isVerticalGrouping || !showAllDayPanel ? 0 : 1;\r\n        var correctedStartRowIndex = startRowIndex + indexDifference;\r\n        return completeViewDataMap.slice(correctedStartRowIndex, correctedStartRowIndex + rowCount).map(function(cellsRow, rowIndex) {\r\n            return cellsRow.map(function(cellData, cellIndex) {\r\n                return {\r\n                    cellData: cellData,\r\n                    position: {\r\n                        rowIndex: rowIndex,\r\n                        cellIndex: cellIndex\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    };\r\n    _proto._getViewDataFromMap = function(viewDataMap, completeViewDataMap, options) {\r\n        var topVirtualRowHeight = options.topVirtualRowHeight,\r\n            bottomVirtualRowHeight = options.bottomVirtualRowHeight,\r\n            cellCountInGroupRow = options.cellCountInGroupRow;\r\n        var isGroupedAllDayPanel = this.workspace.isGroupedAllDayPanel();\r\n        var _viewDataMap$reduce = viewDataMap.reduce(function(_ref, cellsRow) {\r\n                var previousGroupIndex = _ref.previousGroupIndex,\r\n                    previousGroupedData = _ref.previousGroupedData;\r\n                var cellDataRow = cellsRow.map(function(_ref2) {\r\n                    var cellData = _ref2.cellData;\r\n                    return cellData\r\n                });\r\n                var firstCell = cellDataRow[0];\r\n                var isAllDayRow = firstCell.allDay;\r\n                var currentGroupIndex = firstCell.groupIndex;\r\n                if (currentGroupIndex !== previousGroupIndex) {\r\n                    previousGroupedData.push({\r\n                        dateTable: [],\r\n                        isGroupedAllDayPanel: isGroupedAllDayPanel,\r\n                        groupIndex: currentGroupIndex\r\n                    })\r\n                }\r\n                if (isAllDayRow) {\r\n                    previousGroupedData[previousGroupedData.length - 1].allDayPanel = cellDataRow\r\n                } else {\r\n                    previousGroupedData[previousGroupedData.length - 1].dateTable.push(cellDataRow)\r\n                }\r\n                return {\r\n                    previousGroupedData: previousGroupedData,\r\n                    previousGroupIndex: currentGroupIndex\r\n                }\r\n            }, {\r\n                previousGroupIndex: -1,\r\n                previousGroupedData: []\r\n            }),\r\n            groupedData = _viewDataMap$reduce.previousGroupedData;\r\n        var isVirtualScrolling = this.workspace.isVirtualScrolling();\r\n        var isVerticalGrouping = this.workspace._isVerticalGroupedWorkSpace();\r\n        var showAllDayPanel = this.workspace._isShowAllDayPanel();\r\n        if (!isVerticalGrouping && showAllDayPanel) {\r\n            groupedData[0].allDayPanel = completeViewDataMap[0]\r\n        }\r\n        return {\r\n            groupedData: groupedData,\r\n            isVirtual: isVirtualScrolling,\r\n            topVirtualRowHeight: topVirtualRowHeight,\r\n            bottomVirtualRowHeight: bottomVirtualRowHeight,\r\n            cellCountInGroupRow: cellCountInGroupRow\r\n        }\r\n    };\r\n    _proto._generateViewCellsData = function(options, renderRowCount, startRowIndex, rowOffset) {\r\n        var cellCount = options.cellCount,\r\n            cellDataGetters = options.cellDataGetters,\r\n            rowCountInGroup = options.rowCountInGroup;\r\n        var viewCellsData = [];\r\n        for (var i = 0; i < renderRowCount; ++i) {\r\n            var rowIndex = startRowIndex + rowOffset + i;\r\n            var rowIndexInGroup = rowIndex % rowCountInGroup;\r\n            viewCellsData.push(this._generateCellsRow(options, cellDataGetters, rowIndex, cellCount, rowIndexInGroup))\r\n        }\r\n        return viewCellsData\r\n    };\r\n    _proto._generateAllDayPanelData = function(options, groupIndex, rowCount, cellCount) {\r\n        var workSpace = this.workspace;\r\n        if (!workSpace._isShowAllDayPanel()) {\r\n            return null\r\n        }\r\n        var rowIndex = Math.max(groupIndex * rowCount, 0);\r\n        return this._generateCellsRow(options, [workSpace._getAllDayCellData.bind(workSpace)], rowIndex, cellCount, 0, groupIndex)\r\n    };\r\n    _proto._generateCellsRow = function(options, cellDataGetters, rowIndex, cellCount, rowIndexInGroup, groupIndex) {\r\n        var _this = this;\r\n        var cellsRow = [];\r\n        var horizontalGroupCount = options.horizontalGroupCount,\r\n            groupOrientation = options.groupOrientation,\r\n            rowCountInGroup = options.rowCountInGroup,\r\n            cellCountInGroupRow = options.cellCountInGroupRow,\r\n            groupCount = options.groupCount;\r\n        var _loop = function(columnIndex) {\r\n            var cellDataValue = cellDataGetters.reduce(function(data, getter) {\r\n                return _objectSpread(_objectSpread({}, data), getter(void 0, rowIndex, columnIndex, groupIndex).value)\r\n            }, {});\r\n            cellDataValue.index = _this._calculateCellIndex(horizontalGroupCount, groupOrientation, _this._workspace.isGroupedByDate(), rowIndexInGroup, columnIndex, cellCount);\r\n            cellDataValue.isFirstGroupCell = _this._isFirstGroupCell(rowIndex, columnIndex, rowCountInGroup, cellCountInGroupRow, groupCount);\r\n            cellDataValue.isLastGroupCell = _this._isLastGroupCell(rowIndex, columnIndex, rowCountInGroup, cellCountInGroupRow, groupCount);\r\n            cellDataValue.key = _this._getKeyByRowAndColumn(rowIndex, columnIndex, cellCount);\r\n            cellsRow.push(cellDataValue)\r\n        };\r\n        for (var columnIndex = 0; columnIndex < cellCount; ++columnIndex) {\r\n            _loop(columnIndex)\r\n        }\r\n        return cellsRow\r\n    };\r\n    _proto._calculateCellIndex = function(horizontalGroupCount, groupOrientation, isGroupedByDate, rowIndex, columnIndex, columnsNumber) {\r\n        var groupCount = horizontalGroupCount || 1;\r\n        var index = rowIndex * columnsNumber + columnIndex;\r\n        var columnsInGroup = columnsNumber / groupCount;\r\n        if (\"horizontal\" === groupOrientation) {\r\n            var columnIndexInCurrentGroup = columnIndex % columnsInGroup;\r\n            if (isGroupedByDate) {\r\n                columnIndexInCurrentGroup = Math.floor(columnIndex / groupCount)\r\n            }\r\n            index = rowIndex * columnsInGroup + columnIndexInCurrentGroup\r\n        }\r\n        return index\r\n    };\r\n    _proto._getKeyByRowAndColumn = function(rowIndex, columnIndex, cellCount) {\r\n        return rowIndex * cellCount + columnIndex\r\n    };\r\n    _proto.generateGroupedDataMap = function(viewDataMap) {\r\n        var _viewDataMap$reduce2 = viewDataMap.reduce(function(previousOptions, cellsRow) {\r\n                var previousGroupedDataMap = previousOptions.previousGroupedDataMap,\r\n                    previousRowIndex = previousOptions.previousRowIndex,\r\n                    previousGroupIndex = previousOptions.previousGroupIndex;\r\n                var currentGroupIndex = cellsRow[0].cellData.groupIndex;\r\n                var currentRowIndex = currentGroupIndex === previousGroupIndex ? previousRowIndex + 1 : 0;\r\n                cellsRow.forEach(function(cell) {\r\n                    var groupIndex = cell.cellData.groupIndex;\r\n                    if (!previousGroupedDataMap[groupIndex]) {\r\n                        previousGroupedDataMap[groupIndex] = []\r\n                    }\r\n                    if (!previousGroupedDataMap[groupIndex][currentRowIndex]) {\r\n                        previousGroupedDataMap[groupIndex][currentRowIndex] = []\r\n                    }\r\n                    previousGroupedDataMap[groupIndex][currentRowIndex].push(cell)\r\n                });\r\n                return {\r\n                    previousGroupedDataMap: previousGroupedDataMap,\r\n                    previousRowIndex: currentRowIndex,\r\n                    previousGroupIndex: currentGroupIndex\r\n                }\r\n            }, {\r\n                previousGroupedDataMap: [],\r\n                previousRowIndex: -1,\r\n                previousGroupIndex: -1\r\n            }),\r\n            groupedDataMap = _viewDataMap$reduce2.previousGroupedDataMap;\r\n        return groupedDataMap\r\n    };\r\n    _proto._isFirstGroupCell = function(rowIndex, columnIndex, singleGroupRowCount, singleGroupColumnCount, groupCount) {\r\n        if (this.workspace.isGroupedByDate()) {\r\n            return columnIndex % groupCount === 0\r\n        }\r\n        if (this.workspace._isHorizontalGroupedWorkSpace() || 0 === groupCount) {\r\n            return columnIndex % singleGroupColumnCount === 0\r\n        }\r\n        return rowIndex % singleGroupRowCount === 0\r\n    };\r\n    _proto._isLastGroupCell = function(rowIndex, columnIndex, singleGroupRowCount, singleGroupColumnCount, groupCount) {\r\n        if (this.workspace.isGroupedByDate()) {\r\n            return (columnIndex + 1) % groupCount === 0\r\n        }\r\n        if (this.workspace._isHorizontalGroupedWorkSpace() || 0 === groupCount) {\r\n            return (columnIndex + 1) % singleGroupColumnCount === 0\r\n        }\r\n        return (rowIndex + 1) % singleGroupRowCount === 0\r\n    };\r\n    _createClass(ViewDataGenerator, [{\r\n        key: \"workspace\",\r\n        get: function() {\r\n            return this._workspace\r\n        },\r\n        set: function(value) {\r\n            this._workspace = value\r\n        }\r\n    }]);\r\n    return ViewDataGenerator\r\n}();\r\nvar ViewDataProvider = function() {\r\n    function ViewDataProvider(workspace) {\r\n        this._viewDataGenerator = null;\r\n        this._viewData = [];\r\n        this._completeViewDataMap = [];\r\n        this._completeGroupedViewDataMap = [];\r\n        this._viewDataMap = [];\r\n        this._groupedDataMap = [];\r\n        this._workspace = workspace\r\n    }\r\n    var _proto2 = ViewDataProvider.prototype;\r\n    _proto2.update = function(isGenerateNewViewData) {\r\n        var viewDataGenerator = this.viewDataGenerator,\r\n            _workspace = this._workspace;\r\n        var renderOptions = _workspace.generateRenderOptions();\r\n        if (isGenerateNewViewData) {\r\n            this.completeViewDataMap = viewDataGenerator._getCompleteViewDataMap(renderOptions)\r\n        }\r\n        this.viewDataMap = viewDataGenerator._generateViewDataMap(this.completeViewDataMap, renderOptions);\r\n        this.viewData = viewDataGenerator._getViewDataFromMap(this.viewDataMap, this.completeViewDataMap, renderOptions);\r\n        this.groupedDataMap = viewDataGenerator.generateGroupedDataMap(this.viewDataMap)\r\n    };\r\n    _proto2.getStartDate = function() {\r\n        var groupedData = this.viewData.groupedData;\r\n        var dateTable = groupedData[0].dateTable;\r\n        return dateTable[0][0].startDate\r\n    };\r\n    _proto2.getGroupStartDate = function(groupIndex) {\r\n        var _this$getGroupData = this.getGroupData(groupIndex),\r\n            dateTable = _this$getGroupData.dateTable;\r\n        return dateTable[0][0].startDate\r\n    };\r\n    _proto2.getGroupEndDate = function(groupIndex) {\r\n        var _this$getGroupData2 = this.getGroupData(groupIndex),\r\n            dateTable = _this$getGroupData2.dateTable;\r\n        var lastRowIndex = dateTable.length - 1;\r\n        var lastCellIndex = dateTable[lastRowIndex].length - 1;\r\n        return dateTable[lastRowIndex][lastCellIndex].endDate\r\n    };\r\n    _proto2.findGroupCellStartDate = function(groupIndex, startDate, endDate, isAllDay) {\r\n        if (isAllDay) {\r\n            return this.findAllDayGroupCellStartDate(groupIndex, startDate)\r\n        }\r\n        var _this$getGroupData3 = this.getGroupData(groupIndex),\r\n            dateTable = _this$getGroupData3.dateTable;\r\n        if (!dateTable.length) {\r\n            return\r\n        }\r\n        for (var i = 0; i < dateTable[0].length; ++i) {\r\n            var cell = dateTable[0][i];\r\n            var lastRowIndex = dateTable.length - 1;\r\n            if (_date.default.sameDate(cell.startDate, startDate)) {\r\n                var _lastCell;\r\n                var lastCell = dateTable[lastRowIndex][i];\r\n                if (lastCell.endDate <= startDate) {\r\n                    if (endDate.getDate() > startDate.getDate()) {\r\n                        cell = dateTable[0][i + 1];\r\n                        lastCell = dateTable[lastRowIndex][i + 1]\r\n                    }\r\n                }\r\n                if ((null === (_lastCell = lastCell) || void 0 === _lastCell ? void 0 : _lastCell.endDate) > startDate) {\r\n                    return cell.startDate\r\n                }\r\n            }\r\n        }\r\n    };\r\n    _proto2.findAllDayGroupCellStartDate = function(groupIndex, startDate) {\r\n        var groupStartDate = this.getGroupStartDate(groupIndex);\r\n        return groupStartDate > startDate ? groupStartDate : startDate\r\n    };\r\n    _proto2.getCellsGroup = function(groupIndex) {\r\n        var _this$getGroupData4 = this.getGroupData(groupIndex),\r\n            dateTable = _this$getGroupData4.dateTable;\r\n        return dateTable[0][0].groups\r\n    };\r\n    _proto2.getCellData = function(rowIndex, cellIndex, isAllDay) {\r\n        if (isAllDay && !this._workspace._isVerticalGroupedWorkSpace()) {\r\n            return this._viewData.groupedData[0].allDayPanel[cellIndex]\r\n        }\r\n        var cellData = this.viewDataMap[rowIndex][cellIndex].cellData;\r\n        return cellData\r\n    };\r\n    _proto2.getCellsByGroupIndexAndAllDay = function(groupIndex, allDay) {\r\n        var workspace = this._workspace;\r\n        var rowsPerGroup = workspace._getRowCountWithAllDayRows();\r\n        var isVerticalGrouping = workspace._isVerticalGroupedWorkSpace();\r\n        var isShowAllDayPanel = workspace._isShowAllDayPanel();\r\n        var firstRowInGroup = isVerticalGrouping ? groupIndex * rowsPerGroup : 0;\r\n        var lastRowInGroup = isVerticalGrouping ? (groupIndex + 1) * rowsPerGroup - 1 : rowsPerGroup;\r\n        var correctedFirstRow = isShowAllDayPanel && !allDay ? firstRowInGroup + 1 : firstRowInGroup;\r\n        var correctedLastRow = allDay ? correctedFirstRow : lastRowInGroup;\r\n        return this.completeViewDataMap.slice(correctedFirstRow, correctedLastRow + 1).map(function(row) {\r\n            return row.filter(function(_ref3) {\r\n                var currentGroupIndex = _ref3.groupIndex;\r\n                return groupIndex === currentGroupIndex\r\n            })\r\n        })\r\n    };\r\n    _proto2.findCellPositionInMap = function(groupIndex, startDate, isAllDay) {\r\n        var startTime = isAllDay ? _date.default.trimTime(startDate).getTime() : startDate.getTime();\r\n        var isStartTimeInCell = function(cellData) {\r\n            var cellStartTime = cellData.startDate.getTime();\r\n            var cellEndTime = cellData.endDate.getTime();\r\n            return isAllDay ? cellData.allDay && startTime >= cellStartTime && startTime <= cellEndTime : startTime >= cellStartTime && startTime < cellEndTime\r\n        };\r\n        var rows = isAllDay && !this._workspace._isVerticalGroupedWorkSpace() ? [this.completeViewDataMap[0].map(function(cell, index) {\r\n            return {\r\n                cellData: cell,\r\n                position: {\r\n                    cellIndex: index,\r\n                    rowIndex: 0\r\n                }\r\n            }\r\n        })] : this.groupedDataMap[groupIndex] || [];\r\n        for (var rowIndex = 0; rowIndex < rows.length; ++rowIndex) {\r\n            var row = rows[rowIndex];\r\n            for (var cellIndex = 0; cellIndex < row.length; ++cellIndex) {\r\n                var cell = row[cellIndex];\r\n                var cellData = cell.cellData;\r\n                if (cellData.groupIndex === groupIndex) {\r\n                    if (isStartTimeInCell(cellData)) {\r\n                        return cell.position\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return\r\n    };\r\n    _proto2.getGroupIndices = function() {\r\n        var groupedData = this.viewData.groupedData;\r\n        return groupedData.map(function(_ref4) {\r\n            var groupIndex = _ref4.groupIndex;\r\n            return groupIndex\r\n        })\r\n    };\r\n    _proto2._getLastGroupRow = function(groupIndex) {\r\n        var group = this.groupedDataMap[groupIndex];\r\n        var lastIndex = group.length - 1;\r\n        return group[lastIndex]\r\n    };\r\n    _proto2.getLasGroupCellPosition = function(groupIndex) {\r\n        var groupRow = this._getLastGroupRow(groupIndex);\r\n        return groupRow[0].position\r\n    };\r\n    _proto2.getLasGroupCellIndex = function(groupIndex) {\r\n        var group = this.groupedDataMap[groupIndex];\r\n        return group.length - 1\r\n    };\r\n    _proto2.getRowCountInGroup = function(groupIndex) {\r\n        var groupRow = this._getLastGroupRow(groupIndex);\r\n        var cellAmount = groupRow.length;\r\n        var lastCellData = groupRow[cellAmount - 1].cellData;\r\n        var lastCellIndex = lastCellData.index;\r\n        return (lastCellIndex + 1) / groupRow.length\r\n    };\r\n    _proto2.getGroupData = function(groupIndex) {\r\n        var groupedData = this.viewData.groupedData;\r\n        return groupedData.filter(function(item) {\r\n            return item.groupIndex === groupIndex\r\n        })[0]\r\n    };\r\n    _proto2.isGroupIntersectDateInterval = function(groupIndex, startDate, endDate) {\r\n        var groupStartDate = this.getGroupStartDate(groupIndex);\r\n        var groupEndDate = this.getGroupEndDate(groupIndex);\r\n        return startDate < groupEndDate && endDate > groupStartDate\r\n    };\r\n    _proto2.findGlobalCellPosition = function(date) {\r\n        var groupIndex = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;\r\n        var allDay = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : false;\r\n        var completeViewDataMap = this.completeViewDataMap,\r\n            workspace = this._workspace;\r\n        var showAllDayPanel = workspace._isShowAllDayPanel();\r\n        var isVerticalGroupOrientation = workspace._isVerticalGroupedWorkSpace();\r\n        for (var rowIndex = 0; rowIndex < completeViewDataMap.length; rowIndex += 1) {\r\n            var currentRow = completeViewDataMap[rowIndex];\r\n            for (var columnIndex = 0; columnIndex < currentRow.length; columnIndex += 1) {\r\n                var cellData = currentRow[columnIndex];\r\n                var currentStartDate = cellData.startDate,\r\n                    currentEndDate = cellData.endDate,\r\n                    currentGroupIndex = cellData.groupIndex,\r\n                    currentAllDay = cellData.allDay;\r\n                if (groupIndex === currentGroupIndex && allDay === currentAllDay && this._compareDatesAndAllDay(date, currentStartDate, currentEndDate, allDay)) {\r\n                    return {\r\n                        position: {\r\n                            columnIndex: columnIndex,\r\n                            rowIndex: showAllDayPanel && !isVerticalGroupOrientation ? rowIndex - 1 : rowIndex\r\n                        },\r\n                        cellData: cellData\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    _proto2._compareDatesAndAllDay = function(date, cellStartDate, cellEndDate, allDay) {\r\n        var time = date.getTime();\r\n        var trimmedTime = _date.default.trimTime(date).getTime();\r\n        var cellStartTime = cellStartDate.getTime();\r\n        var cellEndTime = cellEndDate.getTime();\r\n        return !allDay && time >= cellStartTime && time < cellEndTime || allDay && trimmedTime === cellStartTime\r\n    };\r\n    _createClass(ViewDataProvider, [{\r\n        key: \"viewDataGenerator\",\r\n        get: function() {\r\n            if (!this._viewDataGenerator) {\r\n                this._viewDataGenerator = new ViewDataGenerator(this._workspace)\r\n            }\r\n            return this._viewDataGenerator\r\n        }\r\n    }, {\r\n        key: \"completeViewDataMap\",\r\n        get: function() {\r\n            return this._completeViewDataMap\r\n        },\r\n        set: function(value) {\r\n            this._completeViewDataMap = value\r\n        }\r\n    }, {\r\n        key: \"completeGroupedViewDataMap\",\r\n        get: function() {\r\n            return this._completeGroupedViewDataMap\r\n        },\r\n        set: function(value) {\r\n            this._completeGroupedViewDataMap = value\r\n        }\r\n    }, {\r\n        key: \"viewData\",\r\n        get: function() {\r\n            return this._viewData\r\n        },\r\n        set: function(value) {\r\n            this._viewData = value\r\n        }\r\n    }, {\r\n        key: \"viewDataMap\",\r\n        get: function() {\r\n            return this._viewDataMap\r\n        },\r\n        set: function(value) {\r\n            this._viewDataMap = value\r\n        }\r\n    }, {\r\n        key: \"groupedDataMap\",\r\n        get: function() {\r\n            return this._groupedDataMap\r\n        },\r\n        set: function(value) {\r\n            this._groupedDataMap = value\r\n        }\r\n    }]);\r\n    return ViewDataProvider\r\n}();\r\nexports.default = ViewDataProvider;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}