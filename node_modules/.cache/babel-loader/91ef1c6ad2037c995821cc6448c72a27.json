{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.grouped.strategy.vertical.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _position = require(\"../../../core/utils/position\");\n\nvar _uiSchedulerWork_spaceGrouped = _interopRequireDefault(require(\"./ui.scheduler.work_space.grouped.strategy\"));\n\nvar _cache = require(\"./cache\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar VERTICAL_GROUPED_ATTR = \"dx-group-column-count\";\nvar DATE_HEADER_OFFSET = 10;\nvar WORK_SPACE_BORDER = 1;\n\nvar VerticalGroupedStrategy = function (_GroupedStrategy) {\n  _inheritsLoose(VerticalGroupedStrategy, _GroupedStrategy);\n\n  function VerticalGroupedStrategy() {\n    return _GroupedStrategy.apply(this, arguments) || this;\n  }\n\n  var _proto = VerticalGroupedStrategy.prototype;\n\n  _proto.prepareCellIndexes = function (cellCoordinates, groupIndex, inAllDayRow) {\n    var rowIndex = cellCoordinates.rowIndex + groupIndex * this._workSpace._getRowCount();\n\n    if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\n      rowIndex += groupIndex;\n\n      if (!inAllDayRow) {\n        rowIndex += 1;\n      }\n    }\n\n    return {\n      rowIndex: rowIndex,\n      cellIndex: cellCoordinates.cellIndex\n    };\n  };\n\n  _proto.calculateCellIndex = function (rowIndex, cellIndex) {\n    rowIndex %= this._workSpace._getRowCount();\n    return this._workSpace._getRowCount() * cellIndex + rowIndex;\n  };\n\n  _proto.getGroupIndex = function (rowIndex) {\n    return Math.floor(rowIndex / this._workSpace._getRowCount());\n  };\n\n  _proto.calculateHeaderCellRepeatCount = function () {\n    return 1;\n  };\n\n  _proto.insertAllDayRowsIntoDateTable = function () {\n    return this._workSpace.option(\"showAllDayPanel\");\n  };\n\n  _proto.getTotalCellCount = function () {\n    return this._workSpace._getCellCount();\n  };\n\n  _proto.getTotalRowCount = function () {\n    return this._workSpace._getRowCount() * this._workSpace._getGroupCount();\n  };\n\n  _proto.addAdditionalGroupCellClasses = function (cellClass, index, i, j) {\n    cellClass = this._addLastGroupCellClass(cellClass, i + 1);\n    return this._addFirstGroupCellClass(cellClass, i + 1);\n  };\n\n  _proto._addLastGroupCellClass = function (cellClass, index) {\n    if (index % this._workSpace._getRowCount() === 0) {\n      return cellClass + \" \" + this.getLastGroupCellClass();\n    }\n\n    return cellClass;\n  };\n\n  _proto._addFirstGroupCellClass = function (cellClass, index) {\n    if ((index - 1) % this._workSpace._getRowCount() === 0) {\n      return cellClass + \" \" + this.getFirstGroupCellClass();\n    }\n\n    return cellClass;\n  };\n\n  _proto.getHorizontalMax = function () {\n    return this._workSpace.getMaxAllowedPosition()[0];\n  };\n\n  _proto.getVerticalMax = function (groupIndex) {\n    var maxAllowedPosition = this._workSpace.getMaxAllowedVerticalPosition(groupIndex);\n\n    maxAllowedPosition += this._getOffsetByAllDayPanel(groupIndex);\n    return maxAllowedPosition;\n  };\n\n  _proto._getOffsetByAllDayPanel = function (groupIndex) {\n    var result = 0;\n\n    if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\n      result = this._workSpace.getAllDayHeight() * (groupIndex + 1);\n    }\n\n    return result;\n  };\n\n  _proto._getGroupTop = function (groupIndex) {\n    var workspace = this._workSpace;\n    var rowCount = workspace.isVirtualScrolling() ? workspace.viewDataProvider.getRowCountInGroup(groupIndex) : workspace._getRowCount();\n    return workspace.getMaxAllowedVerticalPosition(groupIndex) - workspace.getCellHeight() * rowCount;\n  };\n\n  _proto.calculateTimeCellRepeatCount = function () {\n    return this._workSpace._getGroupCount() || 1;\n  };\n\n  _proto.getWorkSpaceMinWidth = function () {\n    var minWidth = this._workSpace._getWorkSpaceWidth();\n\n    var workspaceContainerWidth = (0, _position.getBoundingRect)(this._workSpace.$element().get(0)).width - this._workSpace.getTimePanelWidth() - this._workSpace.getGroupTableWidth() - 2 * WORK_SPACE_BORDER;\n\n    if (minWidth < workspaceContainerWidth) {\n      minWidth = workspaceContainerWidth;\n    }\n\n    return minWidth;\n  };\n\n  _proto.getAllDayOffset = function () {\n    return 0;\n  };\n\n  _proto.getAllDayTableHeight = function () {\n    return 0;\n  };\n\n  _proto.getGroupCountAttr = function () {\n    return {\n      attr: VERTICAL_GROUPED_ATTR,\n      count: this._workSpace.option(\"groups\") && this._workSpace.option(\"groups\").length\n    };\n  };\n\n  _proto.getLeftOffset = function () {\n    return this._workSpace.getTimePanelWidth() + this._workSpace.getGroupTableWidth();\n  };\n\n  _proto.getGroupBoundsOffset = function (cellCount, $cells, cellWidth, coordinates) {\n    var _this = this;\n\n    return _cache.cache.get(\"groupBoundsOffset\", function () {\n      var groupIndex = coordinates.groupIndex;\n      var startOffset = $cells.eq(0).offset().left;\n      var endOffset = $cells.eq(cellCount - 1).offset().left + cellWidth;\n\n      var dayHeight = _this._workSpace._calculateDayDuration() / _this._workSpace.option(\"hoursInterval\") * _this._workSpace.getCellHeight();\n\n      var scrollTop = _this.getScrollableScrollTop();\n\n      var topOffset = groupIndex * dayHeight + (0, _position.getBoundingRect)(_this._workSpace._$thead.get(0)).height + _this._workSpace.invoke(\"getHeaderHeight\") + DATE_HEADER_OFFSET - scrollTop;\n\n      if (_this._workSpace.option(\"showAllDayPanel\") && _this._workSpace.supportAllDayRow()) {\n        topOffset += _this._workSpace.getCellHeight() * (groupIndex + 1);\n      }\n\n      var bottomOffset = topOffset + dayHeight;\n      return _this._groupBoundsOffset = {\n        left: startOffset,\n        right: endOffset,\n        top: topOffset,\n        bottom: bottomOffset\n      };\n    });\n  };\n\n  _proto.shiftIndicator = function ($indicator, height, rtlOffset, i) {\n    var offset = this._workSpace.getIndicatorOffset(0);\n\n    var tableOffset = this._workSpace.option(\"crossScrollingEnabled\") ? 0 : this._workSpace.getGroupTableWidth();\n    var horizontalOffset = rtlOffset ? rtlOffset - offset : offset;\n    var verticalOffset = this._workSpace._getRowCount() * this._workSpace.getCellHeight() * i;\n\n    if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\n      verticalOffset += this._workSpace.getAllDayHeight() * (i + 1);\n    }\n\n    $indicator.css(\"left\", horizontalOffset + tableOffset);\n    $indicator.css(\"top\", height + verticalOffset);\n  };\n\n  _proto.getShaderOffset = function (i, width) {\n    var offset = this._workSpace.option(\"crossScrollingEnabled\") ? 0 : this._workSpace.getGroupTableWidth();\n    return this._workSpace.option(\"rtlEnabled\") ? (0, _position.getBoundingRect)(this._$container.get(0)).width - offset - this._workSpace.getWorkSpaceLeftOffset() - width : offset;\n  };\n\n  _proto.getShaderTopOffset = function (i) {\n    return 0;\n  };\n\n  _proto.getShaderHeight = function () {\n    var height = this._workSpace.getIndicationHeight();\n\n    if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\n      height += this._workSpace.getCellHeight();\n    }\n\n    return height;\n  };\n\n  _proto.getShaderMaxHeight = function () {\n    var height = this._workSpace._getRowCount() * this._workSpace.getCellHeight();\n\n    if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\n      height += this._workSpace.getCellHeight();\n    }\n\n    return height;\n  };\n\n  _proto.getShaderWidth = function () {\n    return this._workSpace.getIndicationWidth(0);\n  };\n\n  _proto.getScrollableScrollTop = function () {\n    return this._workSpace.getScrollable().scrollTop();\n  };\n\n  _proto.getGroupIndexByCell = function ($cell) {\n    var rowIndex = $cell.parent().index();\n\n    var rowCount = this._workSpace._getRowCountWithAllDayRows();\n\n    return Math.ceil((rowIndex + 1) / rowCount);\n  };\n\n  return VerticalGroupedStrategy;\n}(_uiSchedulerWork_spaceGrouped.default);\n\nvar _default = VerticalGroupedStrategy;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["/home/emma/node_modules/devextreme/ui/scheduler/workspaces/ui.scheduler.work_space.grouped.strategy.vertical.js"],"names":["exports","default","_position","require","_uiSchedulerWork_spaceGrouped","_interopRequireDefault","_cache","obj","__esModule","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","VERTICAL_GROUPED_ATTR","DATE_HEADER_OFFSET","WORK_SPACE_BORDER","VerticalGroupedStrategy","_GroupedStrategy","apply","arguments","_proto","prepareCellIndexes","cellCoordinates","groupIndex","inAllDayRow","rowIndex","_workSpace","_getRowCount","supportAllDayRow","option","cellIndex","calculateCellIndex","getGroupIndex","Math","floor","calculateHeaderCellRepeatCount","insertAllDayRowsIntoDateTable","getTotalCellCount","_getCellCount","getTotalRowCount","_getGroupCount","addAdditionalGroupCellClasses","cellClass","index","i","j","_addLastGroupCellClass","_addFirstGroupCellClass","getLastGroupCellClass","getFirstGroupCellClass","getHorizontalMax","getMaxAllowedPosition","getVerticalMax","maxAllowedPosition","getMaxAllowedVerticalPosition","_getOffsetByAllDayPanel","result","getAllDayHeight","_getGroupTop","workspace","rowCount","isVirtualScrolling","viewDataProvider","getRowCountInGroup","getCellHeight","calculateTimeCellRepeatCount","getWorkSpaceMinWidth","minWidth","_getWorkSpaceWidth","workspaceContainerWidth","getBoundingRect","$element","get","width","getTimePanelWidth","getGroupTableWidth","getAllDayOffset","getAllDayTableHeight","getGroupCountAttr","attr","count","length","getLeftOffset","getGroupBoundsOffset","cellCount","$cells","cellWidth","coordinates","_this","cache","startOffset","eq","offset","left","endOffset","dayHeight","_calculateDayDuration","scrollTop","getScrollableScrollTop","topOffset","_$thead","height","invoke","bottomOffset","_groupBoundsOffset","right","top","bottom","shiftIndicator","$indicator","rtlOffset","getIndicatorOffset","tableOffset","horizontalOffset","verticalOffset","css","getShaderOffset","_$container","getWorkSpaceLeftOffset","getShaderTopOffset","getShaderHeight","getIndicationHeight","getShaderMaxHeight","getShaderWidth","getIndicationWidth","getScrollable","getGroupIndexByCell","$cell","parent","_getRowCountWithAllDayRows","ceil","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.grouped.strategy.vertical.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _position = require(\"../../../core/utils/position\");\r\nvar _uiSchedulerWork_spaceGrouped = _interopRequireDefault(require(\"./ui.scheduler.work_space.grouped.strategy\"));\r\nvar _cache = require(\"./cache\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _inheritsLoose(subClass, superClass) {\r\n    subClass.prototype = Object.create(superClass.prototype);\r\n    subClass.prototype.constructor = subClass;\r\n    _setPrototypeOf(subClass, superClass)\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\nvar VERTICAL_GROUPED_ATTR = \"dx-group-column-count\";\r\nvar DATE_HEADER_OFFSET = 10;\r\nvar WORK_SPACE_BORDER = 1;\r\nvar VerticalGroupedStrategy = function(_GroupedStrategy) {\r\n    _inheritsLoose(VerticalGroupedStrategy, _GroupedStrategy);\r\n\r\n    function VerticalGroupedStrategy() {\r\n        return _GroupedStrategy.apply(this, arguments) || this\r\n    }\r\n    var _proto = VerticalGroupedStrategy.prototype;\r\n    _proto.prepareCellIndexes = function(cellCoordinates, groupIndex, inAllDayRow) {\r\n        var rowIndex = cellCoordinates.rowIndex + groupIndex * this._workSpace._getRowCount();\r\n        if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\r\n            rowIndex += groupIndex;\r\n            if (!inAllDayRow) {\r\n                rowIndex += 1\r\n            }\r\n        }\r\n        return {\r\n            rowIndex: rowIndex,\r\n            cellIndex: cellCoordinates.cellIndex\r\n        }\r\n    };\r\n    _proto.calculateCellIndex = function(rowIndex, cellIndex) {\r\n        rowIndex %= this._workSpace._getRowCount();\r\n        return this._workSpace._getRowCount() * cellIndex + rowIndex\r\n    };\r\n    _proto.getGroupIndex = function(rowIndex) {\r\n        return Math.floor(rowIndex / this._workSpace._getRowCount())\r\n    };\r\n    _proto.calculateHeaderCellRepeatCount = function() {\r\n        return 1\r\n    };\r\n    _proto.insertAllDayRowsIntoDateTable = function() {\r\n        return this._workSpace.option(\"showAllDayPanel\")\r\n    };\r\n    _proto.getTotalCellCount = function() {\r\n        return this._workSpace._getCellCount()\r\n    };\r\n    _proto.getTotalRowCount = function() {\r\n        return this._workSpace._getRowCount() * this._workSpace._getGroupCount()\r\n    };\r\n    _proto.addAdditionalGroupCellClasses = function(cellClass, index, i, j) {\r\n        cellClass = this._addLastGroupCellClass(cellClass, i + 1);\r\n        return this._addFirstGroupCellClass(cellClass, i + 1)\r\n    };\r\n    _proto._addLastGroupCellClass = function(cellClass, index) {\r\n        if (index % this._workSpace._getRowCount() === 0) {\r\n            return cellClass + \" \" + this.getLastGroupCellClass()\r\n        }\r\n        return cellClass\r\n    };\r\n    _proto._addFirstGroupCellClass = function(cellClass, index) {\r\n        if ((index - 1) % this._workSpace._getRowCount() === 0) {\r\n            return cellClass + \" \" + this.getFirstGroupCellClass()\r\n        }\r\n        return cellClass\r\n    };\r\n    _proto.getHorizontalMax = function() {\r\n        return this._workSpace.getMaxAllowedPosition()[0]\r\n    };\r\n    _proto.getVerticalMax = function(groupIndex) {\r\n        var maxAllowedPosition = this._workSpace.getMaxAllowedVerticalPosition(groupIndex);\r\n        maxAllowedPosition += this._getOffsetByAllDayPanel(groupIndex);\r\n        return maxAllowedPosition\r\n    };\r\n    _proto._getOffsetByAllDayPanel = function(groupIndex) {\r\n        var result = 0;\r\n        if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\r\n            result = this._workSpace.getAllDayHeight() * (groupIndex + 1)\r\n        }\r\n        return result\r\n    };\r\n    _proto._getGroupTop = function(groupIndex) {\r\n        var workspace = this._workSpace;\r\n        var rowCount = workspace.isVirtualScrolling() ? workspace.viewDataProvider.getRowCountInGroup(groupIndex) : workspace._getRowCount();\r\n        return workspace.getMaxAllowedVerticalPosition(groupIndex) - workspace.getCellHeight() * rowCount\r\n    };\r\n    _proto.calculateTimeCellRepeatCount = function() {\r\n        return this._workSpace._getGroupCount() || 1\r\n    };\r\n    _proto.getWorkSpaceMinWidth = function() {\r\n        var minWidth = this._workSpace._getWorkSpaceWidth();\r\n        var workspaceContainerWidth = (0, _position.getBoundingRect)(this._workSpace.$element().get(0)).width - this._workSpace.getTimePanelWidth() - this._workSpace.getGroupTableWidth() - 2 * WORK_SPACE_BORDER;\r\n        if (minWidth < workspaceContainerWidth) {\r\n            minWidth = workspaceContainerWidth\r\n        }\r\n        return minWidth\r\n    };\r\n    _proto.getAllDayOffset = function() {\r\n        return 0\r\n    };\r\n    _proto.getAllDayTableHeight = function() {\r\n        return 0\r\n    };\r\n    _proto.getGroupCountAttr = function() {\r\n        return {\r\n            attr: VERTICAL_GROUPED_ATTR,\r\n            count: this._workSpace.option(\"groups\") && this._workSpace.option(\"groups\").length\r\n        }\r\n    };\r\n    _proto.getLeftOffset = function() {\r\n        return this._workSpace.getTimePanelWidth() + this._workSpace.getGroupTableWidth()\r\n    };\r\n    _proto.getGroupBoundsOffset = function(cellCount, $cells, cellWidth, coordinates) {\r\n        var _this = this;\r\n        return _cache.cache.get(\"groupBoundsOffset\", function() {\r\n            var groupIndex = coordinates.groupIndex;\r\n            var startOffset = $cells.eq(0).offset().left;\r\n            var endOffset = $cells.eq(cellCount - 1).offset().left + cellWidth;\r\n            var dayHeight = _this._workSpace._calculateDayDuration() / _this._workSpace.option(\"hoursInterval\") * _this._workSpace.getCellHeight();\r\n            var scrollTop = _this.getScrollableScrollTop();\r\n            var topOffset = groupIndex * dayHeight + (0, _position.getBoundingRect)(_this._workSpace._$thead.get(0)).height + _this._workSpace.invoke(\"getHeaderHeight\") + DATE_HEADER_OFFSET - scrollTop;\r\n            if (_this._workSpace.option(\"showAllDayPanel\") && _this._workSpace.supportAllDayRow()) {\r\n                topOffset += _this._workSpace.getCellHeight() * (groupIndex + 1)\r\n            }\r\n            var bottomOffset = topOffset + dayHeight;\r\n            return _this._groupBoundsOffset = {\r\n                left: startOffset,\r\n                right: endOffset,\r\n                top: topOffset,\r\n                bottom: bottomOffset\r\n            }\r\n        })\r\n    };\r\n    _proto.shiftIndicator = function($indicator, height, rtlOffset, i) {\r\n        var offset = this._workSpace.getIndicatorOffset(0);\r\n        var tableOffset = this._workSpace.option(\"crossScrollingEnabled\") ? 0 : this._workSpace.getGroupTableWidth();\r\n        var horizontalOffset = rtlOffset ? rtlOffset - offset : offset;\r\n        var verticalOffset = this._workSpace._getRowCount() * this._workSpace.getCellHeight() * i;\r\n        if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\r\n            verticalOffset += this._workSpace.getAllDayHeight() * (i + 1)\r\n        }\r\n        $indicator.css(\"left\", horizontalOffset + tableOffset);\r\n        $indicator.css(\"top\", height + verticalOffset)\r\n    };\r\n    _proto.getShaderOffset = function(i, width) {\r\n        var offset = this._workSpace.option(\"crossScrollingEnabled\") ? 0 : this._workSpace.getGroupTableWidth();\r\n        return this._workSpace.option(\"rtlEnabled\") ? (0, _position.getBoundingRect)(this._$container.get(0)).width - offset - this._workSpace.getWorkSpaceLeftOffset() - width : offset\r\n    };\r\n    _proto.getShaderTopOffset = function(i) {\r\n        return 0\r\n    };\r\n    _proto.getShaderHeight = function() {\r\n        var height = this._workSpace.getIndicationHeight();\r\n        if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\r\n            height += this._workSpace.getCellHeight()\r\n        }\r\n        return height\r\n    };\r\n    _proto.getShaderMaxHeight = function() {\r\n        var height = this._workSpace._getRowCount() * this._workSpace.getCellHeight();\r\n        if (this._workSpace.supportAllDayRow() && this._workSpace.option(\"showAllDayPanel\")) {\r\n            height += this._workSpace.getCellHeight()\r\n        }\r\n        return height\r\n    };\r\n    _proto.getShaderWidth = function() {\r\n        return this._workSpace.getIndicationWidth(0)\r\n    };\r\n    _proto.getScrollableScrollTop = function() {\r\n        return this._workSpace.getScrollable().scrollTop()\r\n    };\r\n    _proto.getGroupIndexByCell = function($cell) {\r\n        var rowIndex = $cell.parent().index();\r\n        var rowCount = this._workSpace._getRowCountWithAllDayRows();\r\n        return Math.ceil((rowIndex + 1) / rowCount)\r\n    };\r\n    return VerticalGroupedStrategy\r\n}(_uiSchedulerWork_spaceGrouped.default);\r\nvar _default = VerticalGroupedStrategy;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}